var frmViewsDom={},frmViewsModal={},frmViewsUtil={},frmViewsTable={};
(function(){var __=wp.i18n.__;function tag(type,args){var has,setupAttrs,setupTagStyles,setupClasses,setupContent,setupOnClick,output=document.createElement(type);if("undefined"===typeof args)return output;has=makeHas(args);setupAttrs=function(){var callback=function(attr){if(has(attr))output.setAttribute(attr,args[attr])};each(getSupportedSetupAttrs(type),callback)};setupTagStyles=function(){var callback=function(style){if(has(style))output.style[style]=args[style]};each(getSupportedTagStyles(),
callback)};setupClasses=function(){if(has("class"))if("string"===typeof args.class)output.classList.add(args.class);else each(args.class,function(currentClass){output.classList.add(currentClass)})};setupContent=function(){var clone;if(has("text"))output.textContent=args.text;else if(has("children"))each(args.children,function(child){output.appendChild(child)});else if(has("child"))output.appendChild(args.child);else if(has("icon")){clone=document.getElementById(args.icon).cloneNode(true);clone.id=
"";output.appendChild(clone);if(has("backgroundColor")){output.style.backgroundColor=args.backgroundColor;output.style.color="#fff"}}else if(has("html"))output.innerHTML=args.html};setupOnClick=function(){var callback,on,preventDefault=false;if(has("onclick"))callback=args.onclick;else{if(!has("onclickPreventDefault"))return;preventDefault=true;callback=args.onclickPreventDefault}if(!has("id")){console.warn("formidable-views: please provide an id when setting an onclick");return}if(preventDefault)on=
function(event){event.preventDefault();callback(event)};else on=callback;jQuery(document).off("click","#"+args.id);jQuery(document).on("click","#"+args.id,on)};setupAttrs();setupTagStyles();setupClasses();setupContent();setupOnClick();return output}function getSupportedSetupAttrs(type){var attrs=["id","role"];if("label"===type)attrs.push("for");return attrs}function getSupportedTagStyles(){return["padding","margin","border","fontSize","color","opacity","position","textAlign"]}function div(args){return tag("div",
args)}function span(args){return tag("span",args)}function emptyNode(){return document.createTextNode("")}function a(args){var output=tag("a",args);if("undefined"===typeof args.href)args.href="#";if("undefined"!==typeof args.target)output.target=args.target;output.setAttribute("href",args.href);return output}function button(args){if("undefined"===typeof args.class)args.class=[];else if(!Array.isArray(args.class))args.class=[args.class];args.class.push("button");if(-1!==args.class.indexOf("frm-button-secondary"))args.class.push("button-secondary");
else if(-1===args.class.indexOf("frm-views-modal-cancel-button"))args.class.push("button-primary","frm-button-primary");return a(args)}function select(options,args){var output=tag("select",{children:options}),has=makeHas(args);if(has("id")&&has("onchange")){output.id=args.id;jQuery(document).off("change","#"+args.id);jQuery(document).on("change","#"+args.id,args.onchange)}return output}function option(value,textContent,isSelected){var output=document.createElement("option");output.setAttribute("value",
value);output.textContent=textContent;if(isSelected)output.setAttribute("selected","selected");return output}function pullOptionsFrom(templateId,selectedValue){var optionElements,optionIndex,currentOption,currentOptionValue,isSelected,template=document.getElementById(templateId),options=[];if(null===template)return options;if("number"===typeof selectedValue)selectedValue=selectedValue.toString();optionElements=template.querySelectorAll("option");for(optionIndex=0;optionIndex<optionElements.length;++optionIndex){currentOption=
optionElements[optionIndex];currentOptionValue=currentOption.getAttribute("value");if(""!==currentOptionValue){isSelected=currentOptionValue===selectedValue;options.push(option(currentOptionValue,currentOption.textContent,isSelected))}}return options}function radios(options,name){var keys=Object.keys(options);return span({children:map(keys,function(key){return input({id:"radio_"+name+"_"+key,name:name,type:"radio",label:options[key],value:key})}),class:"frm-dom-radios"})}function input(args){var label,
setInputAttribute,has=makeHas(args),output=tag("input",args);if(!has("type"))args.type="text";setInputAttribute=function(attr){if(has(attr))output[attr]=args[attr]};each(getSupportedInputAttrs(),setInputAttribute);if(has("label")){label=tag("label",{text:args.label});if(has("id"))label.setAttribute("for",args.id);output=div({children:[div({child:label}),output]})}if(has("onchange"))if(has("id"))jQuery(document).on("change","#"+args.id,args.onchange);else console.warn("formidable-views: please provide an id when setting an onchange");
return output}function getSupportedInputAttrs(){return["value","placeholder","type","name"]}function tabs(items,args){var passArgs,addTab,outputArgs,has=makeHas(args),state={},children=[];if(has("active"))state.activeTab=args.active;else if("undefined"!==items[0].pageKey)state.activeTab=items[0].pageKey;else state.activeTab=items[0].text;passArgs=function(tabArgs,key,mapKey){if(!has(key))return;if("undefined"!==typeof mapKey)tabArgs[mapKey]=args[key];else tabArgs[key]=args[key]};addTab=function(tabArgs,
index){var newTab;passArgs(tabArgs,"tabClass","class");passArgs(tabArgs,"pageWrapper");passArgs(tabArgs,"stateHandler");newTab=tab(tabArgs,index,state);if(newTab.classList.contains("frm-active-tab"))state.activeTabElement=newTab;children.push(newTab)};each(items,addTab);outputArgs={children:children};if(has("wrapperClass"))outputArgs.class=args.wrapperClass;return div(outputArgs)}function tab(tabArgs,index,state){var element,onclick,isActive,setPage,has=makeHas(tabArgs);if(!has("pageKey"))tabArgs.pageKey=
tabArgs.text;isActive=function(index){return tabArgs.pageKey===state.activeTab};setPage=function(){if(has("page")&&has("pageWrapper")){if(has("stateHandler")&&has("pageKey"))tabArgs.stateHandler(tabArgs.pageKey);redraw(tabArgs.pageWrapper,tabArgs.page())}};if(!Array.isArray(tabArgs.class))tabArgs.class=[tabArgs.class];if(isActive(index))tabArgs.class.push("frm-active-tab");if("undefined"!==typeof tabArgs.onclick)onclick=tabArgs.onclick;else onclick=function(){};tabArgs.onclick=function(){state.activeTabElement.classList.remove("frm-active-tab");
element.classList.add("frm-active-tab");state.activeTabElement=element;setPage();onclick()};element=div(tabArgs);if(isActive())setPage();return element}function collapsible(header,child,args){var content,section,classes=["accordion-section"],has=makeHas(args),open=has("open")&&args.open;header.classList.add("accordion-section-title");header.onclick=function(){open=!open;content.setAttribute("aria-expanded",open);jQuery(section).toggleClass("open",open);if(section.classList.contains("open"))tryToFocusOnFirstAvailableField(section)};
content=div({child:child,class:"accordion-section-content"});content.setAttribute("aria-expanded",open);if(open)classes.push("open");section=div({children:[header,content],class:classes});return section}function tryToFocusOnFirstAvailableField(section){var field=section.querySelector("input");if(null===field)field=section.querySelector("textarea");if(null!==field)field.focus()}function redraw(element,child){element.innerHTML="";element.appendChild(child)}function maybeCreateModal(args){var metaboxHolder,
postbox,top,title,modal,top,content,footer,modalHelper,has=makeHas(args);if("undefined"===typeof args)args={};if(has("id"))modal=document.getElementById(args.id);if(null===modal||"undefined"===typeof modal){modal=div({class:"frm-modal"});if(has("id"))modal.id=args.id;postbox=div({class:"postbox"});metaboxHolder=div({class:"metabox-holder",child:postbox});modal.appendChild(metaboxHolder);document.body.appendChild(modal)}postbox=modal.querySelector(".postbox");modalHelper=getModalHelper(modal,postbox);
if(has("title")){title=modal.querySelector(".frm-modal-title");if(null===title){title=div({child:document.createTextNode(args.title),class:"frm-modal-title"});top=modal.querySelector(".frm_modal_top");if(null===top){top=div({class:"frm_modal_top",children:[title,div({child:a({text:__("Cancel","formidable-views"),class:"dismiss"})})]});postbox.appendChild(top)}}else title.innerHTML=div({child:document.createTextNode(args.title)}).innerHTML}if(has("content"))modalHelper(args.content,"frm_modal_content");
if(has("footer"))modalHelper(args.footer,"frm_modal_footer");makeModalIntoADialogAndOpen(modal);return modal}function getModalHelper(modal,appendTo){return function(child,uniqueClassName){var element=modal.querySelector("."+uniqueClassName);if(null===element){element=div({child:child,class:uniqueClassName});appendTo.appendChild(element)}else redraw(element,child)}}function makeModalIntoADialogAndOpen(modal){var $modal=jQuery(modal);if(!$modal.hasClass("frm-dialog"))$modal.dialog({dialogClass:"frm-dialog",
modal:true,autoOpen:false,closeOnEscape:true,width:"550px",resizable:false,draggable:false,open:function(){jQuery(".ui-dialog-titlebar").addClass("frm_hidden").removeClass("ui-helper-clearfix");jQuery("#wpwrap").addClass("frm_overlay");jQuery(".frm-dialog").removeClass("ui-widget ui-widget-content ui-corner-all");$modal.removeClass("ui-dialog-content ui-widget-content");jQuery(".ui-widget-overlay, a.dismiss").bind("click",function(event){event.preventDefault();$modal.dialog("close")})},close:function(){jQuery("#wpwrap").removeClass("frm_overlay");
jQuery(".spinner").css("visibility","hidden")}});scrollToTop();$modal.dialog("open");return $modal}function scrollToTop(){if("scrollRestoration"in history)history.scrollRestoration="manual";window.scrollTo(0,0)}function recenterModal(modalId){jQuery(document.getElementById(modalId)).dialog("option","position",{my:"center",at:"center",of:window})}function each(items,callback){var index,length=items.length;for(index=0;index<length;index++)callback(items[index],index)}function map(items,callback){var output=
[];each(items,function(item,index){output.push(callback(item,index))});return output}function makeHas(args){if("undefined"===typeof args)return function(){return false};return function(key){return"undefined"!==typeof args[key]}}function post(data,success,error){var handleSuccessCallback=function(responseData){if("function"===typeof success)success(responseData)};jQuery.ajax({type:"POST",url:ajaxurl,data:data,success:function(response){if("undefined"!==typeof response.success&&response.success){if("undefined"===
typeof response.data){handleSuccessCallback({});return}handleSuccessCallback(response.data);if("undefined"!==typeof response.data.redirect)window.location=response.data.redirect}else if("function"===typeof error)error(response)},error:error})}function success(content){var container,notice;container=document.getElementById("wpbody");notice=div({class:["notice","notice-info","frm-review-notice","frm_updated_message"],child:div({class:"frm-satisfied",child:content})});notice.style.borderRadius="4px";
notice.style.right="10px";container.appendChild(notice);setTimeout(function(){jQuery(notice).fadeOut(function(){notice.remove()})},2E3)}function getTableSelectAllAndSearchOptions(){return div({class:"frm_grid_container",margin:"0 0 20px",children:[div({class:"frm_fourth",padding:"10px 0 0 ",child:a({id:"frm_table_columns_select_all",onclickPreventDefault:function(){toggleAllColumnOptions(true)},text:__("Select all","formidable-views")})}),div({class:"frm_fourth",padding:"10px 0 0 ",child:a({id:"frm_table_columns_deselect_all",
onclickPreventDefault:function(){toggleAllColumnOptions(false)},text:__("Deselect all","formidable-views")})}),div({class:"frm_half",child:getTableColumnOptionSearch()})]})}function toggleAllColumnOptions(checked){each(document.querySelectorAll(".frm-new-table-view-option input"),function(option){option.checked=checked})}function getTableColumnOptionSearch(){var search=input({class:["frm-search-input","frm-auto-search"]});search.setAttribute("type","search");search.setAttribute("name","s");search.setAttribute("placeholder",
__("Search for a form field","formidable-views")),search.setAttribute("data-tosearch","frm-new-table-view-option");return tag("p",{class:"frm-search",children:[span({class:["frmfont","frm_search_icon"]}),search]})}frmViewsDom.tag=tag;frmViewsDom.div=div;frmViewsDom.span=span;frmViewsDom.emptyNode=emptyNode;frmViewsDom.a=a;frmViewsDom.button=button;frmViewsDom.select=select;frmViewsDom.option=option;frmViewsDom.pullOptionsFrom=pullOptionsFrom;frmViewsDom.radios=radios;frmViewsDom.input=input;frmViewsDom.tabs=
tabs;frmViewsDom.collapsible=collapsible;frmViewsDom.redraw=redraw;frmViewsDom.success=success;frmViewsModal.maybeCreateModal=maybeCreateModal;frmViewsModal.recenterModal=recenterModal;frmViewsUtil.each=each;frmViewsUtil.map=map;frmViewsUtil.makeHas=makeHas;frmViewsUtil.post=post;frmViewsTable.getTableSelectAllAndSearchOptions=getTableSelectAllAndSearchOptions})();(function(){var dataProcessor,boxProcessor,tag,div,span,emptyNode,a,button,select,option,pullOptionsFrom,radios,input,tabs,collapsible,redraw,success,maybeCreateModal,recenterModal,each,map,makeHas,post,getTableSelectAllAndSearchOptions,copyAutoId=0,boxAutoId=-1,currentAutoId=0,state={activeTab:getDefaultActiveTab(),editBoxContentModalContent:"",layoutBuilderModalData:"",hasResetTinyMceSinceModalLoad:false,limitCustomizationSidebar:false,styleEditorIsActive:0,editingLayoutTemplate:false,storedLayoutBuilderModalData:"",
viewKey:frmViewsEditorViewData.viewKey,educationThatHasBeenShown:[],preventUnsavedChanges:false,tableColumnOptions:[]},__=wp.i18n.__,NUMBER_OF_LAYOUT_OPTIONS=9,LAYOUTS={ONE_COLUMN:1,TWO_COLUMN:2,THREE_COLUMN:3,FOUR_COLUMN:4,ONE_THREE:5,THREE_ONE:6,ONE_TWO_ONE:7,ONE_TWO:8,TWO_ONE:9};function getDefaultActiveTab(){return"listing"}function initialize(){removeHighlightFromSettingsInSidebarNav();highlightViewsInNav();if(drawViewEditor()){setupEventListeners();triggerViewEditorReadyEvent();if(isTableType())getTableColumnOptionsFromServer()}}
function drawViewEditor(){var container=document.getElementById("view-editor");if(null===container)return false;container.appendChild(div({children:[getViewEditorLeftPanel(),getViewEditorRightPanel()]}));return true}function setupEventListeners(){var $document=jQuery(document);$document.on("change","#frm_view_limit",handleLimitChange);$document.on("change","#frm_view_page_size",handlePageSizeChange);$document.on("click",".frm-views-editor-body #publish",saveViewEditor);$document.on("click",".frm-views-editor-body .frm_insert_code",
insertCode);$document.on("click","#frm_edit_box_content_modal #content-tmce",resetTinyMceOnVisualTabClick);$document.on("click","#frm_edit_box_content_modal #content-html",fixTextareaVisibility);$document.on("click",".frm-views-editor-body #sc-formidable",temporarilyHideBoxContentModal);$document.on("thickbox:removed",".frm-views-editor-body",setBoxContentModalVisibilityBack);$document.on("mouseout","#frm_layout_builder_modal_working_space .frm-layout-builder-row",removeActiveRowHoverTarget);$document.on("mouseover",
"#frm_layout_builder_modal_working_space .frm-layout-builder-row",determineActiveRowHoverTarget);$document.on("change","#frm_view_editor_empty_message",handleEmptyMessageChange);$document.on("click","#frm_load_view_in_new_tab",loadViewInNewTab);$document.on("change","#frm_views_editor_filter_groups_wrapper > .frm-target-and-or-select",syncGroupSiblingAndOrValues);$document.on("change",".frm-views-editor-filter-row-wrapper > div > .frm-target-and-or-select",syncNestedSiblingAndOrValues);$document.on("click",
".frm-education-continue",dismissEducation);$document.on("click",".frm-dismiss-coming-soon",dismissComingSoon);$document.on("click",".frm-switch-to-classic-view",handleSwitchToClassicViewClick);$document.on("click","#frm_edit_box_content_modal #insert-media-button",hideContentModalOnMediaButtonClick);$document.on("click","#frm_edit_box_content_modal .su-generator-button",hideContentModalOnShortcodesUltimateClick);if(isGridType()){$document.on("mouseover",".frm-view-editor-entries-wrapper > div:first-child .frm-layout-builder-box-with-0-rows",
maybeAddPreviewAreaControls);$document.on("mouseover",".frm-view-editor-no-entries > div:first-child .frm-layout-builder-box-with-0-rows",maybeAddPreviewAreaControls);$document.on("mouseover",".frm-views-single-entry-wrapper .frm-layout-builder-box-with-0-rows",maybeAddPreviewAreaControls);$document.on("click",".frm-views-editor-body.frm-style-editor-active #frm_view_editor_right",toggleOffCellStyleSettings)}if(isTableType()){$document.on("change",'.frm-new-table-view-option input[type="checkbox"]',
handleTableOptionSelect);$document.on("frm-box-processor-success","#view-editor",setupTableColumnDrag);$document.on("mouseenter","#frm_table_editor_table td",addHoveringOverTdCellClassOnMouseEnter);$document.on("frmAfterSearch","#frm_manage_table_columns_modal .frm-search-input",adjustTableColumnCategoryVisibilityOnSearch);$document.on("click","#frm_table_editor_table th > span:first-child",toggleColumnRenameOnColumnLabelClick)}}function triggerViewEditorReadyEvent(){var editor=document.getElementById("view-editor");
if(null!==editor)jQuery(editor).trigger("frmViewsEditorReady")}function highlightViewsInNav(){var nav,navItems;nav=document.querySelector(".frm_form_nav");if(null===nav)return;navItems=nav.querySelectorAll("a");jQuery(navItems).filter('[href*="edit.php?post_type=frm_display"]').addClass("current_page")}function removeHighlightFromSettingsInSidebarNav(){var $menus=jQuery(document.getElementById("menu-dashboard")).add(jQuery(document.getElementById("menu-posts")));$menus.addClass("wp-not-current-submenu").removeClass("wp-has-current-submenu wp-menu-open");
$menus.find("a.wp-has-submenu").addClass("wp-not-current-submenu").removeClass("wp-has-current-submenu wp-menu-open")}function comingSoonPlaceholder(){return dataProcessor.placeholder("listingContent",function(){if(isCalendarType())return comingSoon("calendar");return emptyNode()})}function comingSoon(type){var icon,title;if(comingSoonIsDismissed())return emptyNode();title=__("The new %1$s is coming soon.","formidable-views");switch(type){case "calendar":icon="frm_views_editor_coming_soon_calendar";
title=title.replace("%1$s",__("Calendar Editor","formidable-views"));break}return div({class:["frm-coming-soon","frm_grid_container"],children:[div({class:"frm1",icon:icon}),div({class:"frm11",children:[span({class:"frm-coming-soon-pill",text:__("COMING SOON","formidable-views")}),div({margin:"5px 0 0",children:[span({text:title}),document.createTextNode(" "),getFormidableSubscribeLink(),document.createTextNode(" "),span({text:__("to receive news about the latest updates.","formidable-views")})]})]}),
getDismissTrigger(type)]})}function comingSoonIsDismissed(){return dataProcessor.data.dismissedCalendarComingSoon}function getDismissTrigger(type){var output=span({class:"frm-dismiss-coming-soon",icon:"frm_views_editor_dismiss_coming_soon"});output.setAttribute("data-type",type);return output}function getFormidableSubscribeLink(){return a({text:__("Subscribe to Formidable Forms","formidable-views"),href:"https://formidableforms.com/newsletter/",target:"_blank"})}function insertCode(e){e.preventDefault();
wpActiveEditor="content";send_to_editor("["+this.getAttribute("data-code")+"]");jQuery(document.getElementById(wpActiveEditor)).trigger("change");return false}function resetTinyMceOnVisualTabClick(){setTimeout(resetTinyMce,0)}function fixTextareaVisibility(){document.getElementById("content").style.visibility="visible"}function temporarilyHideBoxContentModal(){updateUiDialogContainingBoxContentModalVisibility("hidden")}function setBoxContentModalVisibilityBack(){updateUiDialogContainingBoxContentModalVisibility("visible")}
function updateUiDialogContainingBoxContentModalVisibility(visibility){jQuery('.ui-dialog[aria-describedby="frm_edit_box_content_modal"]').css({visibility:visibility})}function removeActiveRowHoverTarget(e){var element=e.currentTarget;if(!element.classList.contains("ui-draggable-dragging"))element.classList.remove("frm-active-hover-target")}function determineActiveRowHoverTarget(e){var element=e.currentTarget;if(document.querySelectorAll(".ui-draggable-dragging").length)return;if(!rowHasANestedHoveredRow(element)){element.classList.add("frm-active-hover-target");
maybeAddRowControls(element)}}function rowHasANestedHoveredRow(rowElement){var $nestedHoveredRows=jQuery(rowElement).find(".frm-layout-builder-row").filter(isHovered);return $nestedHoveredRows.length>0}function isHovered(){return jQuery(this).is(":hover")}function maybeAddRowControls(rowElement){var rowControls,dragIcon,trashIcon;if(jQuery(rowElement).children(".frm-layout-builder-row-controls").length)return;dragIcon=div({class:"frm-row-control-drag",icon:"frm_views_editor_drag"});trashIcon=div({icon:"frm_views_editor_trash",
class:"frm-row-control-delete",id:"frm_trash_icon_"+autoId(),onclick:function(){var rowId,handleDelete;rowId=parseInt(rowElement.getAttribute("frm-row-id"));handleDelete=createDeleteRowFromLayoutBuilderModalDataFunction(rowId);if(boxContentExistsForRow(rowId))confirmDeleteLayoutRow(handleDelete);else handleDelete()}});rowControls=div({class:"frm-layout-builder-row-controls",children:[dragIcon,trashIcon]});rowElement.appendChild(rowControls);jQuery(rowElement).draggable({helper:"clone",revert:"invalid",
delay:10,handle:".frm-row-control-drag",start:adjustDraggableRowSize})}function boxContentExistsForRow(rowId){var boxIds,length,index,boxId;boxIds=getAllBoxIdsForRow(rowId);length=boxIds.length;for(index=0;index<length;++index){boxId=boxIds[index];if(getRawBoxContent({id:boxId}).length>0)return true}return false}function getAllBoxIdsForRow(rowId){var rowLayoutData=checkRowsForLayoutData(rowId,getActiveLayoutData());return false!==rowLayoutData?getAllBoxIdsForBoxes(rowLayoutData.boxes):[]}function checkRowsForLayoutData(rowId,
rows){var length,index,row,layoutData;length=rows.length;for(index=0;index<length;++index){row=rows[index];if(row.id===rowId)return row;layoutData=checkBoxesForLayoutData(rowId,row.boxes);if(false!==layoutData)return layoutData}return false}function checkBoxesForLayoutData(rowId,boxes){var boxLength,boxIndex,box,layoutData;boxLength=boxes.length;for(boxIndex=0;boxIndex<boxLength;++boxIndex){box=boxes[boxIndex];if("undefined"!==typeof box.rows){layoutData=checkRowsForLayoutData(rowId,box.rows);if(false!==
layoutData)return layoutData}}return false}function getAllBoxIdsForBoxes(boxes){var boxIds,boxLength,boxIndex,box;boxIds=[];boxLength=boxes.length;for(boxIndex=0;boxIndex<boxLength;++boxIndex){box=boxes[boxIndex];boxIds=boxIds.concat(getAllBoxIdsForBox(box))}return boxIds}function getAllBoxIdsForBox(boxData){var boxIds=[boxData.id];if("undefined"!==typeof boxData.rows)each(boxData.rows,function(row){boxIds=boxIds.concat(getAllBoxIdsForRow(row.id))});return boxIds}function createDeleteRowFromLayoutBuilderModalDataFunction(rowId){return function(){deleteRowFromLayoutBuilderModalData(rowId,
false)}}function confirmDeleteLayoutRow(handleDelete){var body,confirmOption,args,warning;body=__("All content associated with this section will be deleted. Copy it and paste it into another section or it will be lost.","formidable-views");confirmOption=a({id:"frm_confirm_delete_layout_row",onclickPreventDefault:handleDelete,text:"Delete Section"});args={confirmOption:confirmOption,useClass:"frm-delete-layout-row-warning"};warning=getWarning(body,args);appendToLayoutBuilderModalWorkingSpace(warning)}
function getWarning(body,args){var bodyWrapper,confirmOption,cancelText,warningArgs,warning;bodyWrapper=span({text:body});if("undefined"!==typeof args.confirmOption)bodyWrapper.style.width="calc( 100% - 180px )";else bodyWrapper.style.width="calc( 100% - 90px )";bodyWrapper.style.display="inline-block";if("undefined"===typeof args)args={};if("undefined"===typeof args.useIcon)args.useIcon="frm_delete_layout_row_alert_icon";confirmOption="undefined"!==typeof args.confirmOption?args.confirmOption:emptyNode();
cancelText="undefined"!==typeof args.useCancelText?args.useCancelText:__("Cancel","formidable-views");warningArgs={children:[span({icon:args.useIcon,margin:"0 10px 0 0"}),bodyWrapper,a({id:"frm_cancel_warning_"+autoId(),onclickPreventDefault:function(){warning.remove()},text:cancelText}),confirmOption]};if("undefined"!==typeof args.useClass)warningArgs.class=args.useClass;warning=div(warningArgs);return warning}function maybeAddPreviewAreaControls(){var box,controlOptions,controls,editIcon;box=this;
controls=jQuery(box).children(".frm-preview-box-controls");if(controls.length)return;controls=controls.get(0);boxId=parseInt(box.getAttribute("frm-box-id"));if(isNaN(boxId))boxId=0;if(box.classList.contains("frm-view-editor-top-level-box")){editIcon=div({id:"frm_views_trigger_layout_builder",onclick:onLayoutBuilderToggleClick,icon:"frm_views_editor_layout_builder"});box.appendChild(div({id:"frm_invisible_hover_extension_div"}))}else editIcon=div({id:"frm_trigger_box_content_"+boxId,onclick:function(){triggerBoxContentModalForBox(controls.parentNode)},
icon:"frm_views_editor_edit"});controlOptions=[editIcon];if(isGridType()&&0!==boxId)controlOptions.push(div({id:"frm_enable_style_editor_"+boxId,onclick:createStyleEditorIconOnClickHandler(boxId),icon:"frm_views_editor_droplet"}));controls=div({class:"frm-preview-box-controls",child:div({children:controlOptions})});box.appendChild(controls)}function createStyleEditorIconOnClickHandler(boxId){return function(){enableStyleEditor(boxId)}}function triggerBoxContentModalForBox(box){box.firstChild.click()}
function enableStyleEditor(boxId){var box=findBox(boxId);preserveMetaboxHtml();state.styleEditorIsActive=boxId;document.body.classList.add("frm-style-editor-active");removeActiveStyleEditorClass();box.classList.add("frm-active-style-editor-cell");redrawViewEditorLeftPanel();initializeColorPicker()}function findBox(boxId){var box=null;if(0===boxId)box=document.querySelector(".frm-view-editor-top-level-box");if(null===box)box=document.getElementById("frm_layout_builder_area").querySelector('.frm-layout-builder-box-with-0-rows[frm-box-id="'+
boxId+'"]');return box}function removeActiveStyleEditorClass(){jQuery(".frm-active-style-editor-cell").removeClass("frm-active-style-editor-cell")}function handleColorPickerChange(event){var hexcolor=jQuery(this).wpColorPicker("color");jQuery(event.target).val(hexcolor).trigger("change")}function handleEmptyMessageChange(){updateDataProcessor("emptyMessage",this.value)}function updateDataProcessor(key,value){dataProcessor.data[key]=value;preventUnsavedChanges()}function loadViewInNewTab(){window.open(frmViewsEditorInfo.viewUrl.replace(/#038;p=/g,
"p="),"_blank")}function syncGroupSiblingAndOrValues(){jQuery(this).siblings(".frm-and-or-select").val(this.value)}function syncNestedSiblingAndOrValues(){jQuery(this.parentNode.parentNode).find(".frm-and-or-select").not(this).val(this.value)}function adjustDraggableRowSize(event,ui){var width=jQuery(event.target).width();jQuery(ui.helper).css("width",width+"px")}function deleteRowFromLayoutBuilderModalData(rowId,rowIsBeingTemporarilyReplaced){var deleted=deleteRow(state.layoutBuilderModalData,rowId);
if(deleted&&!rowIsBeingTemporarilyReplaced){if(!state.layoutBuilderModalData.length)state.layoutBuilderModalData="";redrawLayoutBuilderModalWorkingSpace()}return deleted}function deleteRow(rows,rowId){var rowIndex,rowLength,row,deletedRowFromBoxesResult;rowIndex=0;rowLength=rows.length;for(rowIndex=0;rowIndex<rowLength;++rowIndex){row=rows[rowIndex];if(rowId===row.id){rows.splice(rowIndex,1);return row}deletedRowFromBoxesResult=maybeDeleteRowFromBoxes(row.boxes,rowId);if(false!==deletedRowFromBoxesResult)return deletedRowFromBoxesResult}return false}
function maybeDeleteRowFromBoxes(boxes,rowId){var boxIndex,boxLength,deletedRow;boxLength=boxes.length;for(boxIndex=0;boxIndex<boxLength;++boxIndex){if("undefined"===typeof boxes[boxIndex].rows)continue;deletedRow=deleteRow(boxes[boxIndex].rows,rowId);if(false!==deletedRow)return deletedRow}return false}function handleLimitChange(){updateDataProcessor("limit",this.value);refreshLayoutBuilderArea()}function handlePageSizeChange(){updateDataProcessor("pageSize",this.value);refreshLayoutBuilderArea()}
function getViewEditorLeftPanel(){return div({id:"frm_view_editor_left",padding:"20px",children:getActiveViewEditorLeftPanelChildren()})}function redrawViewEditorLeftPanel(){jQuery(document.getElementById("frm_view_editor_left")).replaceWith(getViewEditorLeftPanel());initializeColorPicker()}function initializeColorPicker(){jQuery("#frm_view_editor_left").find("[id^=frm_color_picker_]").wpColorPicker({change:handleColorPickerChange})}function getActiveViewEditorLeftPanelChildren(){var additionalChildren=
0===state.styleEditorIsActive?getDefaultLeftPanelChildren():getStyleEditorLeftPanelChildren();return[getActiveViewTypeDescription(),separator()].concat(additionalChildren)}function getSwitchToClassicViewOption(){return a({class:"frm-switch-to-classic-view",children:[span({icon:"frm_view_editor_switch_to_classic_mode_icon"}),span({text:__("Switch to Classic","formidable-views")})]})}function getDefaultLeftPanelChildren(){var children,noEntriesTextareaWrapper;children=[wrapFormInput({id:"frm_view_name",
onchange:function(){updateViewData("name",this.value)},label:__("View Name","formidable-views"),value:frmViewsEditorViewData.name}),getShortcodeExample(),getPhpEchoExample(),separator(),getSettingsForActiveViewType(),getDisplaySettings(),getMetaboxes()];noEntriesTextareaWrapper=collapsible(div({text:__("No Entries Message","formidable-views")}),getNoEntriesTextarea());noEntriesTextareaWrapper.id="frm_no_entries_textarea_collapsible";children.push(noEntriesTextareaWrapper);return children}function updateViewData(key,
value){frmViewsEditorViewData[key]=value;preventUnsavedChanges()}function getViewKeyInput(){var output=wrapFormInput({id:"frm_views_view_key",onchange:function(){state.viewKey=this.value;preventUnsavedChanges()},label:__("View Key","formidable-views"),value:frmViewsEditorViewData.viewKey});output.style.margin="10px 0 0";return output}function getDetailSlugPlaceholder(){var placeholder=dataProcessor.placeholder("detailSlug",maybeGetDetailSlugInput);placeholder.id="frm_views_detail_slug_wrapper";return placeholder}
function maybeGetDetailSlugInput(detailSlug){var wrappedInput;if(!viewIsDynamic())return emptyNode();wrappedInput=wrapFormInput({id:"frm_views_detail_slug",class:"frm_half",onchange:function(){updateDataProcessor("detailSlug",this.value);refreshLayoutBuilderArea()},label:__("Detail Page Slug","formidable-views"),value:detailSlug});if(isSingleEntryType()||isCalendarType())wrappedInput.style.marginTop=0;appendTooltipTriggerAferInputLabel(wrappedInput,getDetailSlugInputTooltipText());wrappedInput.firstChild.classList.add("frm_grid_container");
jQuery(wrappedInput.querySelector("#frm_views_detail_slug")).after(getParameterValueDropdown());return wrappedInput}function getDetailSlugInputTooltipText(){var text=__("Example: If parameter name is 'contact', the url would be like %1$s/selected-page?contact=2. If this entry is linked to a post, the post permalink will be used instead.","formidable-views");return text.replace("%1$s",frmViewsEditorInfo.siteUrl)}function getParameterValueDropdown(){var dropdown=select([option("id","ID","id"===dataProcessor.data.parameterValue),
option("display_key","Key","display_key"===dataProcessor.data.parameterValue)]);dropdown.id="frm_views_parameter_value";dropdown.classList.add("frm_half");jQuery(document).off("change","#"+dropdown.id);jQuery(document).on("change","#"+dropdown.id,function(){updateDataProcessor("parameterValue",this.value);refreshLayoutBuilderArea()});return dropdown}function refreshDetailSlug(){var detailSlugWrapper=document.getElementById("frm_views_detail_slug_wrapper");if(null!==detailSlugWrapper)redraw(detailSlugWrapper,
getDetailSlugPlaceholder())}function getDisplaySettings(){var children=[];if(!isSingleEntryType()&&!isCalendarType())children.push(div({class:"frm_grid_container",margin:"0 0 10px",children:[getLimitPlaceholder(),getPageSizePlaceholder()]}));children.push(getDetailSlugPlaceholder(),dataProcessor.placeholder("previewFilter",getPreviewFilterDropdown),dataProcessor.placeholder("disablePreview",getDisablePreviewCheckbox));if(frmViewsEditorInfo.includeCopyOption)children.push(dataProcessor.placeholder("copy",
getCopyViewCheckbox));children.push(getViewKeyInput(),getFormSelectWrapper());return collapsible(div({text:__("Advanced Settings","formidable-views")}),div({children:children}),{open:!isCalendarType()&&!isGridType()&&!isTableType()})}function getFormSelectWrapper(){return div({margin:"10px 0 0",children:[getFormSelectLabel(),getFormSelect()]})}function getLimitPlaceholder(){var limitPlaceholder=dataProcessor.placeholder("limit",getViewLimitInput);limitPlaceholder.classList.add("frm_half");return limitPlaceholder}
function getTooltipTrigger(text,placement){var output=span({class:["frm_help","frm_icon_font","frm_tooltip_icon"]});output.setAttribute("title",text);output.style.position="relative";output.style.top="3px";output.style.left="4px";if("undefined"!==typeof placement)output.setAttribute("data-placement",placement);return output}function getPageSizePlaceholder(){var pageSizePlaceholder=dataProcessor.placeholder("pageSize",getPageSizeInput);pageSizePlaceholder.classList.add("frm_half");return pageSizePlaceholder}
function getCalendarSettings(){return collapsible(div({text:__("Calendar Settings","formidable-views")}),dataProcessor.placeholder("fieldOptions",function(){return div({children:[div({children:[tag("label",{text:__("Event Date","formidable-views")}),select(getEventDateOptions(dataProcessor.data.dateFieldId),{id:"frm_date_field_id",onchange:function(){updateDataProcessor("dateFieldId",this.value)}})]}),div({margin:"10px 0 0",children:[tag("label",{text:__("End Date or Day Count","formidable-views")}),
select(getEndDateOrDayCountOptions(dataProcessor.data.edateFieldId),{id:"frm_edate_field_id",onchange:function(){updateDataProcessor("edateFieldId",this.value)}})]}),div({class:"frm_grid_container",children:[getRepeatField(),div({margin:"10px 0 0",class:"frm_half",children:[getEndRepeatLabel(),getEndRepeatSelect()]})]})]})}),{open:true})}function getRepeatField(){var output=div({margin:"10px 0 0",class:"frm_half",children:[tag("label",{text:__("Repeat","formidable-views")}),select(getEventRepeatOptions(dataProcessor.data.repeatEventFieldId),
{id:"frm_repeat_event_field_id",onchange:function(){updateDataProcessor("repeatEventFieldId",this.value)}})]});appendTooltipTriggerAferInputLabel(output,getRepeatFieldTooltipText());return output}function getRepeatFieldTooltipText(){return __("Select a field from your form that contains values like 1 week, 2 weeks, 1 year, etc. This will set the repeat period for each event.","formidable-views")}function getEndRepeatLabel(){var output=tag("label",{text:__("End Repeat","formidable-views")});if(""===
dataProcessor.data.repeatEventFieldId)output.classList.add("frm-disabled-label");return output}function getEndRepeatSelect(){var output=select(getEventEndRepeatOptions(dataProcessor.data.repeatEdateFieldId),{id:"frm_repeat_edate_field_id",onchange:function(){updateDataProcessor("repeatEdateFieldId",this.value)}});if(""===dataProcessor.data.repeatEventFieldId)output.disabled=true;jQuery(document).on("change","#frm_repeat_event_field_id",function(){output.disabled=""===this.value;jQuery(output).prev("label").toggleClass("frm-disabled-label",
output.disabled)});return output}function getEventDateOptions(selectedValue){return getFieldOptions(["created_at","updated_at","date"],selectedValue)}function getEndDateOrDayCountOptions(selectedValue){return getFieldOptions(["created_at","updated_at","date","number","select","radio","scale","star"],selectedValue)}function getEventRepeatOptions(selectedValue){var options=getFieldOptions(["select","radio"],selectedValue);return[option("",__("No repeating events","formidable-views"),""===selectedValue)].concat(options)}
function getEventEndRepeatOptions(selectedValue){var options=getFieldOptions(["date"],selectedValue);return[option("",__("Never","formidable-views"),""===selectedValue)].concat(options)}function getSettingsForActiveViewType(){if(isGridType())return getGridStyleSettings();if(isCalendarType())return getCalendarSettings();if(isTableType())return getTableSettings();return emptyNode()}function getGridStyleSettings(){return collapsible(div({text:__("Grid Style Settings","formidable-views")}),dataProcessor.placeholder("gridColumnCount",
function(){setTimeout(initializeColorPicker,0);return div({children:[getCellTypographySettings(),getCellBackgroundSettings(),getCellBorderSettings(),getCellBorderRadiusSettings(),getCellPaddingSettings(),getCellStyleSettings(__("Number of grid columns","formidable-views"),div({child:getNumberOfGridColumnsInput()})),getCellStyleSettings(__("Row gap","formidable-views"),div({child:getGridRowGapInput()})),getCellStyleSettings(__("Column gap","formidable-views"),div({child:getGridColumnGapInput()})),
getGridResponsivenessWrapper(),getCustomClassesSettings()]})}),{open:true})}function getCustomClassesSettings(){return getCellStyleSettings(tag("label",{text:__("Custom classes","formidable-views"),for:"frm_custom_classes_input"}),div({class:"frm-full-width-settings-input",child:getCustomClassesInput()}))}function getTableSettings(){return collapsible(div({text:__("Table Settings","formidable-views")}),div({children:[tag("label",{text:__("Row Style","formidable-views")}),dataProcessor.placeholder("tableRowStyle",
getTableRowStyleDropdown),getTableResponsivenessWrapper(),dataProcessor.placeholder("customClasses",getCustomClassesSettings)]}),{open:true})}function getTableRowStyleDropdown(tableRowStyle){return select([option("",__("Match theme settings","formidable-views"),""===tableRowStyle),option("frm-alt-table",__("Zebra stripes","formidable-views"),"frm-alt-table"===tableRowStyle),option("frm-grid",__("Grid","formidable-views"),"frm-grid"===tableRowStyle)],{id:"frm_table_row_style",onchange:function(){var table=
document.getElementById("frm_table_editor_table");dataProcessor.data.tableRowStyle=this.value;jQuery(table).removeClass("frm-alt-table frm-grid");if(""!==this.value)table.classList.add(this.value)}})}function getTableResponsivenessWrapper(){return dataProcessor.placeholder("tableResponsive",function(){var checkbox,label,wrapper;checkbox=getTableResponsivenessInput();label=tag("label",{text:__("Make table responsive","formidable-views"),fontSize:"14px",for:checkbox.id});wrapper=div({margin:"5px 0 0",
children:[checkbox,label]});appendTooltipTriggerAferInputLabel(wrapper,__("If this is on, the each column will display as a full row when the browser window is smaller than 760px width.","formidable-views"),"right");return wrapper})}function getTableResponsivenessInput(){var output=input({id:"frm_table_responsive_"+autoId(),onchange:handleTableResponsivenessChange,type:"checkbox"});output.checked=!!dataProcessor.data.tableResponsive;return output}function handleTableResponsivenessChange(){dataProcessor.data.tableResponsive=
this.checked?1:0;preventUnsavedChanges()}function getGridResponsivenessWrapper(){var checkbox,label,wrapper;checkbox=getGridResponsivenessInput();label=tag("label",{text:__("Make grid responsive","formidable-views"),fontSize:"14px",for:checkbox.id});wrapper=div({children:[checkbox,label]});appendTooltipTriggerAferInputLabel(wrapper,__("If this is on, the number of grid columns will go to one when the browser window is smaller than 750px width.","formidable-views"),"right");return wrapper}function getFieldOptions(types,
selectedValue){var results=[];if(-1!==types.indexOf("created_at"))results.push(option("created_at",__("Entry creation date","formidable-views"),"created_at"===selectedValue));if(-1!==types.indexOf("updated_at"))results.push(option("updated_at",__("Entry update date","formidable-views"),"updated_at"===selectedValue));each(dataProcessor.data.fieldOptions,function(fieldOption){each(types,function(type){if(type===fieldOption.type)results.push(option(fieldOption.value,fieldOption.label,selectedValue===
fieldOption.value))})});return results}function getMetaboxes(){var wrapper=document.getElementById("frm_view_editor_metabox_wrapper");if(null===wrapper)return emptyNode();return collapsible(div({text:__("Metaboxes","formidable-views")}),wrapper)}function getStyleEditorLeftPanelChildren(){return[getCellSettingsHeader(),separator(),getCellTypographySettings(),getCellBackgroundSettings(),getCellBorderSettings(),getCellBorderRadiusSettings(),getCellPaddingSettings()]}function getCellSettingsHeader(){var settings=
getCellStyleSettings(__("Cell Settings","formidable-views"),div({child:getCellSettingsDoneButton()}));settings.firstChild.style.fontWeight="600";return settings}function getCellSettingsDoneButton(){return button({id:"frm_done_cell_style_settings",onclickPreventDefault:function(){toggleOffCellStyleSettings();saveViewEditor()},text:__("Done","formidable-views")})}function toggleOffCellStyleSettings(event){if(0===state.styleEditorIsActive)return;if("undefined"!==typeof event&&clickedToTurnOnCellStyleSettings(event))return;
state.styleEditorIsActive=0;removeActiveStyleEditorClass();redrawViewEditorLeftPanel();document.body.classList.remove("frm-style-editor-active")}function clickedToTurnOnCellStyleSettings(event){var trigger=event.originalEvent.target;return"svg"===trigger.nodeName&&-1!==trigger.parentNode.id.indexOf("frm_enable_style_editor_")}function dismissEducation(event){event.preventDefault();jQuery(this).closest(".frm-education").parent().remove()}function dismissComingSoon(){var data={action:"frm_dismiss_coming_soon_message",
type:this.getAttribute("data-type"),nonce:frmGlobal.nonce};jQuery(this).closest(".frm-coming-soon").parent().remove();post(data)}function handleSwitchToClassicViewClick(event){event.preventDefault();toggleOffCellStyleSettings();maybeCreateModal({id:"frm_switch_to_classic_view_modal",title:__("Switch to Classic View","formidable-views"),content:getSwitchToClassicViewModalContent(),footer:getSwitchToClassicViewFooter()})}function hideContentModalOnMediaButtonClick(){var uploader=document.querySelector("#wpwrap ~ div .media-modal");
if(null!==uploader){uploader=uploader.parentNode;setupTemporaryBoxContentModalToggle(function(){return"none"===uploader.style.display})}}function hideContentModalOnShortcodesUltimateClick(){var uploader=document.querySelector(".mfp-wrap");if(null!==uploader)setupTemporaryBoxContentModalToggle(function(){return!uploader.classList.contains("mfp-ready")})}function setupTemporaryBoxContentModalToggle(statusCallback){var interval;temporarilyHideBoxContentModal();interval=setInterval(function(){if(statusCallback()){setBoxContentModalVisibilityBack();
clearInterval(interval)}},50)}function getSwitchToClassicViewModalContent(){var line2Text=__("This is irreversible. You will not be able to change back to a %1$s after updating.","formidable-views");line2Text=line2Text.replace("%1$s",isGridType()?getGridTypeDescriptionText():getTableTypeDescriptionText());return div({padding:"20px",children:[div({text:__("Switching to classic gives you full control of your HTML, but it means that you will no longer have access to the layout builder or style editor tools.",
"formidable-views")}),div({margin:"15px 0 0",text:line2Text}),div({margin:"15px 0 0",text:__("Are you sure you want to switch?","formidable-views")})]})}function getSwitchToClassicViewFooter(){return div({children:[button({text:__("Switch","formidable-views"),id:"frm_confirm_switch_to_classic",onclickPreventDefault:switchToClassicView})]})}function switchToClassicView(){var button=document.getElementById("frm_confirm_switch_to_classic");if(button.classList.contains("frm_loading_button"))return;button.classList.add("frm_loading_button");
post({action:"frm_flatten_view",listingLayout:dataProcessor.data.listingLayout,listingContent:dataProcessor.data.listingContent,detailLayout:dataProcessor.data.detailLayout,detailContent:dataProcessor.data.detailContent,view:frmViewsEditorViewData.id,nonce:frmGlobal.nonce,type:frmViewsEditorInfo.isGridType?"grid":"table"},function(data){var wasGridType,wasTableType,tablePreviewArea;wasGridType=isGridType();wasTableType=isTableType();preventUnsavedChanges();frmViewsEditorInfo.isGridType=0;frmViewsEditorInfo.isTableType=
0;dataProcessor.data.listingLayout="";dataProcessor.data.listingContent=data.listingContent;if(wasGridType){dataProcessor.data.detailLayout="";dataProcessor.data.detailContent=data.detailContent;document.getElementById("frm_layout_builder_toggle").remove()}if(wasTableType){tablePreviewArea=document.querySelector(".frm_table_preview_area");if(null!==tablePreviewArea){tablePreviewArea.classList.remove("frm_table_preview_area");tablePreviewArea.classList.add("frm_div_preview_area")}dataProcessor.data.listingBeforeContent+=
data.beforeContent+"<tbody>";dataProcessor.data.listingAfterContent="</tbody></table>"+dataProcessor.data.listingAfterContent}refreshLayoutBuilderArea();redrawViewEditorLeftPanel();closeModal("frm_switch_to_classic_view_modal")})}function getCellTypographySettings(){var selectedOption,dropdown,customSizeInput;selectedOption=getActiveStyle("fontSize");dropdown=select([option("",__("Default","formidable-views"),""===selectedOption),option(18,__("Small","formidable-views"),"18px"===selectedOption),option(21,
__("Regular","formidable-views"),"21px"===selectedOption),option(26.25,__("Large","formidable-views"),"26.25px"===selectedOption),option(32,__("Larger","formidable-views"),"32px"===selectedOption),option("custom",__("Custom","formidable-views"),isCustomFontSize(selectedOption))],{id:"frm_cell_typography_settings",onchange:function(){var value;if("custom"!==this.value){value=""!==this.value?this.value+"px":"";updateStyleSetting("fontSize",value);updateStyleSetting("lineHeight",value);customSizeInput.value=
value}}});customSizeInput=input({id:"frm_custom_font_size_"+autoId(),value:selectedOption,placeholder:"21px",onchange:function(){dropdown.value=isCustomFontSize(this.value)?"custom":this.value.replace("px","");updateStyleSetting("fontSize",this.value);updateStyleSetting("lineHeight",this.value)}});return getCellStyleSettings(__("Typography","formidable-views"),div({children:[dropdown,customSizeInput]}))}function isCustomFontSize(size){return-1===["","18px","21px","26.25px","32px"].indexOf(size)}function preserveMetaboxHtml(){var metaboxes=
document.getElementById("frm_view_editor_metabox_wrapper");if(null===metaboxes)return;if(jQuery(metaboxes).closest("#frm_view_editor_left").length)jQuery("#view-editor").next().append(metaboxes)}function getCellBackgroundSettings(){var colorPicker=getColorPicker(handleBackgroundColorChange,"backgroundColor");return getCellStyleSettings(__("Background","formidable-views"),div({child:colorPicker}))}function handleBackgroundColorChange(){updateStyleSetting("backgroundColor",this.value)}function updateStyleSetting(key,
value){var boxId,boxData,activePageContent,styles;boxId=state.styleEditorIsActive;boxData=searchPageContentForBoxId(boxId);if(false===boxData){boxData={box:boxId,content:"",style:{}};activePageContent=getActivePageContent();activePageContent=activePageContent.concat([boxData]);updateActivePageContent(activePageContent,false)}else if("undefined"===typeof boxData.style)boxData.style={};boxData.style[key]=value;preventUnsavedChanges();styles={};styles[key]=value;if(onListingTab())applyStyleToAllEntries(boxId,
styles,true);else applyStyles(getStyleEditorTargetBox(),styles,hasTopLevel()&&0===boxId,true)}function hasTopLevel(){return null!==document.querySelector(".frm-view-editor-top-level-box")}function applyStyleToAllEntries(boxId,styles,updatingStyles){var enforceMinimumPadding,targetBoxes;if(hasTopLevel()&&0===boxId){enforceMinimumPadding=true;targetBoxes=getTopLevelBoxes()}else{enforceMinimumPadding=false;targetBoxes=getAllBoxesWithId(boxId)}each(targetBoxes,function(box){applyStyles(box,styles,enforceMinimumPadding,
updatingStyles)})}function getTopLevelBoxes(){var entriesWrapper,boxes;entriesWrapper=document.querySelector(".frm-view-editor-entries-wrapper");boxes=[];if(null!==entriesWrapper)each(entriesWrapper.childNodes,function(box){boxes.push(box.firstChild)});return boxes}function getAllBoxesWithId(boxId){var boxes=[];each(document.getElementById("frm_view_editor_preview_area").querySelectorAll(".frm-layout-builder-box-with-0-rows"),function(box){if(boxId===parseInt(box.getAttribute("frm-box-id")))boxes.push(box.firstChild)});
return boxes}function getStyleEditorTargetBox(){var targetBoxId;if(0===state.styleEditorIsActive)return findBox(0);targetBoxId="frm-mca-"+state.activeTab+"-box-"+state.styleEditorIsActive+"_child";return document.getElementById(targetBoxId)}function searchPageContentForBoxId(boxId){var content,box,index;content=getActivePageContent();if(0===boxId&&"string"===typeof content){box={box:0,content:content};updateActivePageContent([box],false);return box}for(index=0;index<content.length;++index){box=content[index];
if(boxId===box.box)return box}return false}function getCellBorderSettings(){var options,dropdown,sizeInput,colorPicker,rightSide;options=getBorderTypeOptions();dropdown=select(options);dropdown.id="frm_select_cell_border_"+autoId();jQuery(document).on("change","#"+dropdown.id,handleCellBorderStyleChange);sizeInput=getCellBorderSizeInput(handleCellBorderSizeChange);colorPicker=getColorPicker(handleCellBorderColorChange,"borderColor");rightSide=div({children:[dropdown,sizeInput,colorPicker]});return getCellStyleSettings(__("Border",
"formidable-views"),rightSide)}function handleCellBorderStyleChange(){updateStyleSetting("borderStyle",this.value)}function getCellBorderSizeInput(changeHandler){var borderWidth,inputArgs;borderWidth=getActiveStyle("borderWidth");inputArgs={id:"frm_cell_border_"+autoId(),onchange:changeHandler,placeholder:"1px"};if(""!==borderWidth)inputArgs.value=borderWidth;return input(inputArgs)}function getActiveStyles(){var boxData=searchPageContentForBoxId(state.styleEditorIsActive);return"undefined"!==typeof boxData.style?
boxData.style:{}}function getActiveStyle(key){var styles,styleIsSet,useDefaultGridStyle;styles=getActiveStyles();styleIsSet="undefined"!==typeof styles[key];if(styleIsSet)return styles[key];useDefaultGridStyle=0===state.styleEditorIsActive&&"undefined"!==typeof frmViewsEditorInfo.defaultGridStyles[key];if(useDefaultGridStyle)return frmViewsEditorInfo.defaultGridStyles[key];return""}function handleCellBorderSizeChange(){updateStyleSetting("borderWidth",this.value)}function handleCellBorderColorChange(){updateStyleSetting("borderColor",
this.value)}function getBorderTypeOptions(){var borderStyle,selectedValue;borderStyle=getActiveStyle("borderStyle");selectedValue=borderStyle?borderStyle:"none";return[option("dotted",__("Dotted","formidable-views"),"dotted"===selectedValue),option("dashed",__("Dashed","formidable-views"),"dashed"===selectedValue),option("solid",__("Solid","formidable-views"),"solid"===selectedValue),option("double",__("Double","formidable-views"),"double"===selectedValue),option("groove",__("Groove","formidable-views"),
"groove"===selectedValue),option("ridge",__("Ridge","formidable-views"),"ridge"===selectedValue),option("inset",__("Inset","formidable-views"),"inset"===selectedValue),option("outset",__("Outset","formidable-views"),"outset"===selectedValue),option("none",__("None","formidable-views"),"none"===selectedValue),option("hidden",__("Hidden","formidable-views"),"hidden"===selectedValue)]}function getCellBorderRadiusSettings(){var borderRadiusInput,advancedBorderRadiusSettings,borderRadiusWrapper,split,
isAdvanced;borderRadiusInput=input({id:"frm_cell_border_radius_"+autoId(),onchange:handleBorderRadiusChange,value:getActiveStyle("borderRadius"),placeholder:"10px"});advancedBorderRadiusSettings=div({class:["frm_grid_container","frm-advanced-border-radius-settings"],children:map(["top_left","top_right","bottom_right","bottom_left"],function(corner){return div({class:"frm_fourth",position:"relative",children:[input({class:"frm-border-radius-corner-input",id:"frm_cell_border_radius_"+autoId(),onchange:function(){setBorderRadiusStyle(corner,
this.value)},value:getBorderRadiusStyle(corner),placeholder:"10px"}),span({class:"frm-border-radius-corner-icon-wrapper",icon:"frm_view_editor_border_radius_corner_icon"})]})})});split=getActiveStyle("borderRadius").split(" ");isAdvanced=split.length>1;if(isAdvanced)borderRadiusInput.style.display="none";else advancedBorderRadiusSettings.style.display="none";borderRadiusWrapper=div({children:[borderRadiusInput,advancedBorderRadiusSettings]});borderRadiusWrapper.style.setProperty("margin-right","35px",
"important");return getCellStyleSettings(__("Border radius","formidable-views"),div({children:[borderRadiusWrapper,span({id:"frm_toggle_border_radius_"+autoId(),onclick:function(){isAdvanced=!isAdvanced;if(isAdvanced){borderRadiusInput.style.display="none";advancedBorderRadiusSettings.style.display="grid";each(advancedBorderRadiusSettings.querySelectorAll(".frm-border-radius-corner-input"),function(individualCornerInput,index){var corner;switch(index){case 0:corner="top_left";break;case 1:corner=
"top_right";break;case 2:corner="bottom_right";break;case 3:corner="bottom_left";break}individualCornerInput.value=getBorderRadiusStyle(corner);if(0===index)individualCornerInput.focus()})}else{borderRadiusInput.style.display="block";advancedBorderRadiusSettings.style.display="none";borderRadiusInput.value=getActiveStyle("borderRadius")}},class:"frm-border-radius-icon-wrapper",icon:"frm_view_editor_toggle_border_radius_icon"})]}))}function setBorderRadiusStyle(corner,value){var style,split,topLeftBorderRadius,
topRightBorderRadius,bottomRightBorderRadius,bottomLeftBorderRadius,mergedBorderRadius;style=getActiveStyle("borderRadius");split=style.split(" ");topLeftBorderRadius=split[0];topRightBorderRadius=1===split.length?split[0]:split[1];bottomRightBorderRadius=1===split.length?split[0]:split[2];bottomLeftBorderRadius=1===split.length?split[0]:split[3];switch(corner){case "top_left":topLeftBorderRadius=value;break;case "top_right":topRightBorderRadius=value;break;case "bottom_right":bottomRightBorderRadius=
value;break;case "bottom_left":bottomLeftBorderRadius=value;break}mergedBorderRadius=topLeftBorderRadius+" "+topRightBorderRadius+" "+bottomRightBorderRadius+" "+bottomLeftBorderRadius;if(""===mergedBorderRadius.trim())mergedBorderRadius="";else if(""===topLeftBorderRadius||""===topRightBorderRadius||""===bottomRightBorderRadius||""===bottomLeftBorderRadius){if(""===topLeftBorderRadius)topLeftBorderRadius=0;if(""===topRightBorderRadius)topRightBorderRadius=0;if(""===bottomRightBorderRadius)bottomRightBorderRadius=
0;if(""===bottomLeftBorderRadius)bottomLeftBorderRadius=0;mergedBorderRadius=topLeftBorderRadius+" "+topRightBorderRadius+" "+bottomRightBorderRadius+" "+bottomLeftBorderRadius}else if(topLeftBorderRadius===topRightBorderRadius&&topLeftBorderRadius===bottomRightBorderRadius&&topLeftBorderRadius===bottomLeftBorderRadius)mergedBorderRadius=topLeftBorderRadius;updateStyleSetting("borderRadius",mergedBorderRadius)}function getBorderRadiusStyle(corner){var split=getActiveStyle("borderRadius").split(" ");
switch(corner){case "top_left":return split[0];case "top_right":return 1===split.length?split[0]:split[1];case "bottom_right":return 1===split.length?split[0]:split[2];case "bottom_left":return 1===split.length?split[0]:split[3]}}function handleBorderRadiusChange(){updateStyleSetting("borderRadius",this.value)}function getCellPaddingSettings(){var paddingInput=input({id:"frm_cell_padding_"+autoId(),onchange:handleCellPaddingChange,value:getActiveStyle("padding"),placeholder:"10px"});return getCellStyleSettings(__("Padding",
"formidable-views"),div({child:paddingInput}))}function handleCellPaddingChange(){updateStyleSetting("padding",this.value)}function getCellStyleSettings(label,rightSide){var labelWrapper="string"===typeof label?div({text:label}):div({child:label});return div({class:"frm-cell-style-settings",children:[labelWrapper,rightSide]})}function getNumberOfGridColumnsInput(){var output=input({id:"frm_number_of_columns_input_"+autoId(),onchange:handleNumberOfColumnsChange,value:convertGridColumnCountToInputVale(dataProcessor.data.gridColumnCount)});
output.type="range";output.min=1;output.max=6;output.step=1;return output}function convertGridColumnCountToInputVale(gridColumnCount){var inputValue=parseInt(gridColumnCount);switch(gridColumnCount){case 6:inputValue=5;break;case 12:inputValue=6;break}return inputValue}function getGridResponsivenessInput(){var output=input({id:"frm_grid_responsive_"+autoId(),onchange:handleGridResponsivenessChange,type:"checkbox"});output.checked=!!dataProcessor.data.gridResponsive;return output}function handleGridResponsivenessChange(){dataProcessor.data.gridResponsive=
this.checked?1:0;preventUnsavedChanges()}function getCustomClassesInput(){return input({id:"frm_custom_classes_input",onchange:handleCustomClassChange,value:dataProcessor.data.customClasses})}function handleCustomClassChange(){var previousValue,target;previousValue=dataProcessor.data.customClasses;dataProcessor.data.customClasses=this.value;preventUnsavedChanges();target=document.querySelector(".frm-view-editor-entries-wrapper");if(null===target)return;reduceCustomClasses(previousValue).forEach(function(customClass){return target.classList.remove(customClass)});
reduceCustomClasses(this.value).forEach(function(customClass){return target.classList.add(customClass)})}function getGridRowGapInput(){var output=input({id:"frm_row_gap_input_"+autoId(),onchange:handleRowGapChange,value:dataProcessor.data.gridRowGap});output.type="range";output.min=0;output.max=50;output.step=5;return output}function getGridColumnGapInput(){var output=input({id:"frm_column_gap_input_"+autoId(),onchange:handleColumnGapChange,value:dataProcessor.data.gridColumnGap});output.type="range";
output.min=0;output.max=5;output.step=1;return output}function handleNumberOfColumnsChange(){var count;switch(parseInt(this.value)){case 1:count=1;break;case 2:count=2;break;case 3:count=3;break;case 4:count=4;break;case 5:count=6;break;case 6:count=12;break}updateDataProcessor("gridColumnCount",count);each(document.querySelector(".frm-view-editor-entries-wrapper").childNodes,function(node){node.classList.remove("frm_full","frm_half","frm_third","frm_fourth","frm_sixth","frm1");node.classList.add(getClassForColumnCount())})}
function getClassForColumnCount(){switch(dataProcessor.data.gridColumnCount){case 2:return"frm_half";case 3:return"frm_third";case 4:return"frm_fourth";case 6:return"frm_sixth";case 12:return"frm1";default:return"frm_full"}}function handleRowGapChange(){updateDataProcessor("gridRowGap",this.value);syncGridGapStyles()}function handleColumnGapChange(){updateDataProcessor("gridColumnGap",this.value);syncGridGapStyles()}function syncGridGapStyles(){document.querySelector(".frm-view-editor-entries-wrapper").style["grid-gap"]=
dataProcessor.data.gridRowGap+"px "+dataProcessor.data.gridColumnGap+"%"}function getColorPicker(changeHandler,key){var output=input({id:"frm_color_picker_"+autoId(),onchange:changeHandler,value:getActiveStyle(key)});output.style.width="50px";return output}function getViewLimitInput(limit){var output=input({id:"frm_view_limit",label:__("Limit","formidable-views"),value:limit});appendTooltipTriggerAferInputLabel(output,getViewLimitTooltipText(),"right");return output}function getViewLimitTooltipText(){return __("If you don\u2019t want all your entries displayed, you can insert the number limit here. Leave blank if you\u2019d like all entries shown.",
"formidable-views")}function appendTooltipTriggerAferInputLabel(wrapper,tooltipText,placement){jQuery(wrapper.querySelector("label")).after(getTooltipTrigger(tooltipText,placement))}function getPageSizeInput(pageSize){var output=input({id:"frm_view_page_size",label:__("Page Size","formidable-views"),value:pageSize});appendTooltipTriggerAferInputLabel(output,getPageSizeTooltipText());return output}function getPageSizeTooltipText(){return __("The number of entries to show per page. Leave blank to not use pagination.",
"formidable-views")}function getCopyViewCheckbox(copy){var checkbox,label;checkbox=tag("input");checkbox.id="frm_views_copy_view";checkbox.setAttribute("type","checkbox");label=tag("label",{text:__("Copy this View to other sites when Formidable Forms is activated","formidable-views"),for:checkbox.id});if(copy)checkbox.checked=true;jQuery(document).off("change","#"+checkbox.id);jQuery(document).on("change","#"+checkbox.id,function(){updateDataProcessor("copy",this.checked?1:0)});return div({margin:"10px 0 0",
children:[checkbox,label]})}function getDisablePreviewCheckbox(disablePreview){var checkbox,label;checkbox=tag("input");checkbox.id="frm_views_disable_preview";checkbox.setAttribute("type","checkbox");label=tag("label",{text:__("Show code for this view","formidable-views"),for:checkbox.id});if(disablePreview){checkbox.checked=true;toggleCodeViewActiveClass(true)}checkbox.disabled=isLegacyTableType();jQuery(document).off("change","#"+checkbox.id);jQuery(document).on("change","#"+checkbox.id,function(){updateDataProcessor("disablePreview",
this.checked?1:0);toggleCodeViewActiveClass(this.checked);refreshActivePreviews()});return div({margin:"10px 0 0",children:[checkbox,label,getTooltipTrigger(getShowCodeForThisViewTooltipText())]})}function toggleCodeViewActiveClass(on){jQuery(document.getElementById("frm_view_editor_preview_area")).toggleClass("frm-code-view-active",on)}function getShowCodeForThisViewTooltipText(){return __("This box is forcibly checked if you include a <table> tag in the Before Content box. If you are editing a view and notice the visual tab is selected and your table HTML is missing, you can switch to the HTML tab, close the content pop up, and reopen it. As long as the settings have not been saved, your old HTML will be back to way it was before loading it in the visual tab. While this is checked, the preview will also display the HTML as code.",
"formidable-views")}function getPreviewFilterDropdown(){return div({margin:"10px 0 0",children:[tag("label",{text:__("Filter Content","formidable-views")}),select([option("0",__("Run Formidable shortcodes only","formidable-views"),"0"===frmViewsEditorViewData.activePreviewFilter),option("limited",__("Add paragraphs and process shortcodes","formidable-views"),"limited"===frmViewsEditorViewData.activePreviewFilter),option("1",__("Run all content through WordPress (not recommended)","formidable-views"),
"1"===frmViewsEditorViewData.activePreviewFilter)],{id:"frm_active_preview_filter",onchange:function(){updateViewData("activePreviewFilter",this.value);redraw(document.getElementById("frm_views_shortcode_example"),getShortcodeExample());refreshLayoutBuilderArea()}})]})}function getFormSelectLabel(){return div({child:tag("label",{text:__("Use Entries from Form","formidable-views"),margin:"0 0 4px"})})}function getFormSelect(){var id,output;id="frm_views_editor_form_select";output=select([option("",
__("Select datasource","formidable-views"))].concat(pullOptionsFrom("frm_data_source_form_select_template",frmViewsEditorViewData.formId)));output.id=id;jQuery(document).off("change","#"+id);jQuery(document).on("change","#"+id,handleFormSelect);return output}function handleFormSelect(){updateViewData("formId",this.value);pullFormInfo();refreshLayoutBuilderArea();refreshCustomizationSidebar();if(isTableType())getTableColumnOptionsFromServer()}function pullFormInfo(){var data={action:"frm_views_editor_info",
form:frmViewsEditorViewData.formId,nonce:frmGlobal.nonce};post(data,updateEditorAfterPull)}function updateEditorAfterPull(data){setFieldSelectTemplateOptions(data.fieldSelectTemplateOptions);frmViewsEditorInfo.dateFieldIds=data.dateFieldIds;frmViewsEditorInfo.draftDropdownOptions=data.draftDropdownOptions;frmViewsEditorInfo.statusDropdownOptions=data.statusDropdownOptions;frmViewsEditorInfo.statusFieldId=data.statusFieldId}function setFieldSelectTemplateOptions(newHtml){document.getElementById("frm_field_select_template").innerHTML=
newHtml}function refreshCustomizationSidebar(){jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"frm_get_cd_tags_box",form_id:frmViewsEditorViewData.formId,nonce:frmGlobal.nonce},success:function(html){document.getElementById("frm_adv_info").querySelector(".categorydiv").innerHTML=html}})}function refreshLayoutBuilderArea(){setupBoxProcessor();redrawLayoutBuilderArea()}function getActiveViewTypeDescription(){if(isSingleEntryType())return getSingleEntryTypeDescription();if(isCalendarType())return getCalendarTypeDescription();
if(isGridType())return getGridTypeDescription();if(isTableType())return getTableTypeDescription();return getClassicViewTypeDescription()}function refreshActiveViewTypeDescription(){if(!isSingleEntryType()){refreshDetailSlug();return}}function isGridType(){return 1===frmViewsEditorInfo.isGridType}function isTableType(){return 1===frmViewsEditorInfo.isTableType}function useTableTags(){return isTableType()&&onListingTab()}function onListingTab(){return"listing"===state.activeTab}function isSingleEntryType(){return"one"===
frmViewsEditorViewData.showCount}function isCalendarType(){return"calendar"===frmViewsEditorViewData.showCount}function isLegacyTableType(){return!isSingleEntryType()&&!isCalendarType()&&hasTableInBeforeContent()}function hasTableInBeforeContent(){var tableRegex=new RegExp("<table"),closingTableRegex=new RegExp("</table>");return tableRegex.test(dataProcessor.data.listingBeforeContent)&&!closingTableRegex.test(dataProcessor.data.listingBeforeContent)}function viewIsDynamic(){return detailPageContentIsSet()||
listingPageContentContainsALinkToDetailPage()}function detailPageContentIsSet(){return""!==dataProcessor.data.detailContent}function listingPageContentContainsALinkToDetailPage(){var isTable,index;if(""===dataProcessor.data.listingContent)return false;if("string"===typeof dataProcessor.data.listingContent)return-1!==dataProcessor.data.listingContent.indexOf("[detaillink]");isTable=isTableType();for(index=0;index<dataProcessor.data.listingContent.length;++index){if(-1!==dataProcessor.data.listingContent[index].content.indexOf("[detaillink]"))return true;
if(isTable&&dataProcessor.data.listingContent[index].detailsLink)return true}return false}function getViewTypeDescription(icon,label){return div({children:[icon,div({text:label,class:"frm-view-type-description"})]})}function getClassicViewTypeDescription(){return getViewTypeDescription(getClassicViewIcon(),__("Classic","formidable-views"))}function getClassicViewIcon(){var icon=div({icon:"frm_views_editor_classic_view_icon",class:["frm-views-type-icon","frm-center-child","frm-views-classic-type-icon"]});
icon.style.backgroundColor="#F4AD3D";return icon}function getGridTypeDescription(){var description=getViewTypeDescription(getGridIcon(),getGridTypeDescriptionText());description.style.position="relative";description.appendChild(getSwitchToClassicViewOption());return description}function getGridTypeDescriptionText(){return __("Grid view","formidable-views")}function getGridIcon(){return div({icon:"frm_view_icon_grid",backgroundColor:"#805EF6",class:["frm-views-type-icon","frm-center-child"]})}function getTableTypeDescription(){var description=
getViewTypeDescription(getTableIcon(),getTableTypeDescriptionText());description.style.position="relative";description.appendChild(getSwitchToClassicViewOption());return description}function getTableTypeDescriptionText(){return __("Table view","formidable-views")}function getTableIcon(){return div({icon:"frm_view_icon_table",backgroundColor:"#68DADC",class:["frm-views-type-icon","frm-center-child"]})}function getSingleEntryTypeDescription(){return getViewTypeDescription(getSingleEntryIcon(),__("Single entry",
"formidable-views"))}function getSingleEntryIcon(){return div({icon:"frm_view_icon_one",backgroundColor:"#68DADC",class:["frm-views-type-icon","frm-center-child"]})}function getCalendarTypeDescription(){return getViewTypeDescription(getCalendarIcon(),__("Calendar","formidable-views"))}function getCalendarIcon(){return div({icon:"frm_view_icon_calendar",backgroundColor:"rgb(65, 153, 253)",class:["frm-views-type-icon","frm-center-child"]})}function wrapFormInput(args){args.margin="5px 0 0 0";return div({child:input(args),
margin:"10px 0 0 0"})}function getShortcodeExample(){return div({id:"frm_views_shortcode_example",child:getExampleWithCopyAction("[display-frm-data id="+frmViewsEditorViewData.id+"]",{margin:"15px 0 0"})})}function getPhpEchoExample(){return getExampleWithCopyAction("<?php echo FrmViewsDisplaysController::get_shortcode( array( 'id' => "+frmViewsEditorViewData.id+" ) ); ?>",{margin:"10px 0 15px"})}function getExampleWithCopyAction(text,wrapperArgs){if("undefined"===typeof frmViewsEditorViewData){console.warn("formidable-views: frmViewsEditorViewData is not set, unable to get example with copy action");
return div()}if("undefined"===typeof wrapperArgs)wrapperArgs={};wrapperArgs.children=[div({text:text}),getCopyAction(text)];wrapperArgs.class="frm-example-with-copy-action";return div(wrapperArgs)}function getCopyAction(text){return a({text:__("Copy","formidable-views"),id:"frm_copy_"+getUniqueCopyId(),onclickPreventDefault:onCopyActionClick(text)})}function getUniqueCopyId(){return copyAutoId++}function onCopyActionClick(text){return function(){copyToClipboard(text)}}function getNoEntriesTextarea(){var output=
tag("textarea");output.id="frm_view_editor_empty_message";dataProcessor.get("emptyMessage",function(emptyMessage){output.value=emptyMessage});return output}function getViewEditorRightPanel(){if(isSingleEntryType())return getViewEditorRightPanelForSingleEntryType();return getViewEditorRightPanelForDynamicType()}function getViewEditorRightPanelForSingleEntryType(){return div({id:"frm_view_editor_right",child:dataProcessor.placeholder("listingContent",getListingPage)})}function getViewEditorRightPanelForDynamicType(){var pageWrapper=
div();return div({id:"frm_view_editor_right",children:[getListingDetailsPageToggles(pageWrapper),separator(),pageWrapper]})}function getListingDetailsPageToggles(pageWrapper){return div({class:"frmcenter",child:tabs([{text:__("Listing Page","formidable-views"),id:"frm_views_trigger_listing_page",page:getListingPage,pageKey:"listing"},{text:__("Detail Page","formidable-views"),id:"frm_views_trigger_detail_page",page:getDetailPage,pageKey:"detail"}],{active:state.activeTab,tabClass:"frm-listing-details-page-toggle",
wrapperClass:"frm-listing-details-page-toggles",pageWrapper:pageWrapper,stateHandler:onPageToggleUpdate})})}function getListingPage(){var addBeforeContentWrapper=getBeforeContentWrapper(),addAfterContentWrapper=getAfterContentWrapper();return getViewEditorPreviewArea([getBeforeLayoutBuilderToggleOptions(),comingSoonPlaceholder(),addBeforeContentWrapper,getLayoutBuilderArea(),addAfterContentWrapper])}function getDetailPage(){return getViewEditorPreviewArea([getBeforeLayoutBuilderToggleOptions(),getLayoutBuilderArea()])}
function getViewEditorPreviewArea(children){var output=div({id:"frm_view_editor_preview_area",class:useTableTags()?"frm_table_preview_area":"frm_div_preview_area",padding:"0 60px 30px",children:children});if(dataProcessor.data.disablePreview)output.classList.add("frm-code-view-active");return output}function getBeforeContentWrapper(){return getBeforeOrAfterContentWrapper("before")}function getBeforeOrAfterContentWrapper(type){var key="before"===type?"listingBeforeContent":"listingAfterContent";return dataProcessor.placeholder(key,
function(html){var args={},children=[],wrapperArgs,wrapper;if("before"===type)updateBeforeContentInput(html);if(html.length){wrapperArgs={class:"frm-disable-clicking-in-content"};if(useHtmlInsteadOfPreview())wrapperArgs.text=html;else wrapperArgs.html=html;wrapper=div(wrapperArgs);boxProcessor.watch(type+"Content",function(){var processedHtml=boxProcessor.state.details[type+"Content"];processedHtml=processedHtml.replace(/\[siteurl\]/g,frmViewsEditorInfo.siteUrl);processedHtml=processedHtml.replace(/\[sitename\]/g,
frmViewsEditorInfo.siteName);processedHtml=processedHtml.replace(/\[entry_count\]/g,boxProcessor.state.details.entryCount);if(useHtmlInsteadOfPreview())wrapper.textContent=processedHtml;else wrapper.innerHTML=processedHtml});children.push(wrapper)}else children.push(div({class:"frm-add-"+type+"-icon",icon:"frm_views_editor_plus_circle"}),div({class:"frm-add-"+type+"-content",text:getBeforeOrAfterContentWrapperText(type)}));args.child=div({id:"frm_"+type+"_view_content_wrapper",onclick:function(){var boxData=
{id:0,useContent:type+"_content"};editBoxContentModal(boxData)},class:["frm-working-space-border","with_frm_style","frm_clearfix"],children:children});if(!html.length)args.child.classList.add("frm-empty-content-wrapper");return div(args)})}function getBeforeOrAfterContentWrapperText(type){switch(type){case "after":return __("Add After Content","formidable-views");case "before":return __("Add Before Content","formidable-views")}return""}function onPageToggleUpdate(pageKey){state.activeTab=pageKey;
setupBoxProcessor()}function getBeforeLayoutBuilderToggleOptions(){return dataProcessor.placeholder("listingBeforeContent",function(){var args,filterSortOptions;args={id:"frm_before_layout_builder_toggle_options",margin:"10px 15px 15px",children:[]};if(onListingTab()){filterSortOptions=[a({id:"frm_layout_builder_filter_entries",onclickPreventDefault:onFilterEntriesClick,children:[getFilterIcon(),span({text:__("Filter entries","formidable-views")}),getFilterSortCounter("filterEntries")],margin:"0 15px 0 0"}),
a({id:"frm_layout_builder_sort_entries",onclickPreventDefault:onSortEntriesClick,children:[getSortIcon(),span({text:__("Sort entries","formidable-views")}),getFilterSortCounter("sortEntries")],margin:"0 15px 0 0"})];if(isTableType())filterSortOptions.push(a({id:"frm_layout_builder_manage_columns",onclickPreventDefault:onManageTableColumnsClick,children:[span({text:__("Manage columns","formidable-views")})]}));args.children.push(span({id:"frm_view_editor_filter_sort_wrapper",children:filterSortOptions}))}if(isGridType())args.children.push(a({id:"frm_layout_builder_toggle",
onclickPreventDefault:onLayoutBuilderToggleClick,text:__("Layout builder","formidable-views")}));return div(args)})}function getFilterIcon(){return div({icon:"frm_views_filter_entries_icon"})}function getSortIcon(){return div({icon:"frm_views_sort_entries_icon"})}function getFilterSortCounter(key){var placeholder=dataProcessor.placeholder(key,function(settings){var number=getCircleCountNumber(settings,key);if(!number)return emptyNode();return getCircleCountWrapper(span({text:number}))},"span");placeholder.id=
"frm_"+key+"_counter";return placeholder}function getCircleCountWrapper(child){return span({class:"frm-circle-count-wrapper",child:child})}function getCircleCountNumber(settings,key){var validRules;if("filterEntries"===key)validRules=filterForValidFilterRules(settings);else validRules=filterForValidSortRules(settings);return validRules.length}function filterForValidFilterRules(settings){return filterForValidRules(settings,"where")}function filterForValidSortRules(settings){return filterForValidRules(settings,
"by")}function filterForValidRules(settings,requiredKey){var index,rule,theRequiredKeyIsNotEmpty,length=settings.length,filtered=[];for(index=0;index<length;++index){rule=settings[index];theRequiredKeyIsNotEmpty=!!rule[requiredKey];if(theRequiredKeyIsNotEmpty)filtered.push(rule)}return filtered}function onFilterEntriesClick(){var modalId="frm_filter_entries_modal";maybeCreateModal({id:modalId,title:__("Filter entries","formidable-views"),content:getFilterEntriesModalContent(),footer:getFilterEntriesModalFooter(modalId)})}
function getFilterEntriesModalContent(){return div({padding:"20px 0",child:dataProcessor.placeholder("filterEntries",function(filterSettings){var groupedFilterSettings=groupFilterSettings(filterSettings);if(!groupedFilterSettings.length)groupedFilterSettings.push({settings:[],or:0});return div({id:"frm_views_editor_filter_entries_modal_content",children:[div({id:"frm_views_editor_filter_groups_wrapper",children:addButtonsBetweenFilterGroups(groupedFilterSettings)}),getAddNewFilterGroupTrigger()]})})})}
function groupFilterSettings(filters){var dataByGroupId={};each(filters,function(filter){var groupIsNotDefined="undefined"===typeof dataByGroupId[filter.group];if(groupIsNotDefined)dataByGroupId[filter.group]={settings:[],or:filter.group_or};dataByGroupId[filter.group].settings.push(filter)});return Object.values(dataByGroupId)}function addButtonsBetweenFilterGroups(groupedFilterSettings){var output=[];each(groupedFilterSettings,function(filterData,index){var andOrSelect;if(0!==index){andOrSelect=
getAndOrSelect(filterData.or,1!==index);if(1===index)andOrSelect.classList.add("frm-target-and-or-select");output.push(andOrSelect)}output.push(getFilterEntriesGroup(filterData.settings,index))});return output}function getFilterEntriesGroup(filterSettings,index){var entries,handleGroupDelete,deleteGroupToggle,args,group;entries=filterSettings.length?filterSettings:[{}];handleGroupDelete=function(){var $group,$andOrSelect,parent;$group=jQuery(group);$andOrSelect=$group.prev(".frm-and-or-select");parent=
group.parentNode;if(!$andOrSelect.length)$andOrSelect=$group.next(".frm-and-or-select");$andOrSelect.add($group).remove();if(!parent.children.length)addFilterEntriesModalGroup();else updateTargetGroupAndOrSelect(parent.children,false);recenterFilterEntriesModal()};deleteGroupToggle=div({id:"frm_delete_group_"+index,onclick:handleGroupDelete,child:div({class:"frm-delete-group-toggle",icon:"frm_views_editor_trash"})});args={class:"frm-views-editor-filter-group",children:[repeatRows("filter",entries,
getFilterEntriesModalRow,"filter_"+index),deleteGroupToggle]};if(0!==index)args.margin="15px 0 0 0 ";group=div(args);return group}function recenterFilterEntriesModal(){recenterModal("frm_filter_entries_modal")}function updateTargetGroupAndOrSelect(children){var $targetSelect=jQuery(children).filter(".frm-and-or-select").first();$targetSelect.addClass("frm-target-and-or-select");$targetSelect.prop("disabled",false)}function getAddNewFilterGroupTrigger(){return div({margin:"20px 0 0",child:a({id:"frm_view_editor_add_new_filter_group",
onclickPreventDefault:addFilterEntriesModalGroup,children:[span({icon:"frm_row_plus_circle_icon",margin:"0 5px 0 0"}),span({text:__("Add new group","formidable-views")})]})})}function addFilterEntriesModalGroup(){var wrapper,orSelected,disabled,andOrSelect;wrapper=document.getElementById("frm_views_editor_filter_groups_wrapper");if(wrapper.children.length){orSelected="or"===jQuery(wrapper.children).filter(".frm-and-or-select").first().val();disabled=wrapper.children.length>2;andOrSelect=getAndOrSelect(orSelected,
disabled);if(!disabled)andOrSelect.classList.add("frm-target-and-or-select");wrapper.appendChild(andOrSelect)}wrapper.appendChild(getFilterEntriesGroup([],getAnAvailableFilterGroupId()));recenterFilterEntriesModal()}function getAnAvailableFilterGroupId(){var groupId=1;while(null!==document.getElementById("frm_delete_group_"+groupId))++groupId;return groupId}function getFilterEntriesModalRow(filter,index){var andOrSelect,valueInput,fieldSelect;andOrSelect=getAndOrSelect(filter.or,1!==index);valueInput=
getFilterValueInput(filter.where,filter.val);fieldSelect=getFieldSelect(filter.where,valueInput);if(1===index)andOrSelect.classList.add("frm-target-and-or-select");return div({margin:"10px 0",children:[andOrSelect,fieldSelect,getOperatorSelect(filter.is),valueInput]})}function getFilterValueInput(where,value){var statusDropdown,draftDropdown,valueInput;if("is_draft"===where){draftDropdown=select(getDraftDropdownOptions(value));draftDropdown.classList.add("frm-filter-value");return draftDropdown}if(frmViewsEditorInfo.statusFieldId===
parseInt(where)){statusDropdown=select(getStatusDropdownOptions(value));statusDropdown.classList.add("frm-filter-value");return statusDropdown}valueInput=input({value:value,placeholder:__("Enter value","formidable-views"),class:"frm-filter-value"});if(fieldIsADateField(where))setTimeout(function(){setupDateFilter(valueInput)},0);return valueInput}function getDraftDropdownOptions(selectedValue){return Object.keys(frmViewsEditorInfo.draftDropdownOptions).map(function(value){return option(value,frmViewsEditorInfo.draftDropdownOptions[value],
selectedValue===value)})}function getStatusDropdownOptions(selectedValue){return Object.keys(frmViewsEditorInfo.statusDropdownOptions).map(function(value){return option(value,frmViewsEditorInfo.statusDropdownOptions[value],selectedValue===value)})}function getAndOrSelect(orSelected,disabled){var output=select([option("and",__("And","formidable-views"),!orSelected),option("or",__("Or","formidable-views"),orSelected)]);output.classList.add("frm-and-or-select");if(true===disabled)output.disabled=true;
return output}function getFieldSelect(selectedValue,valueInput){var isSort,selectArgs,output,previousValue;if("undefined"===typeof selectedValue)selectedValue="";isSort="undefined"===typeof valueInput;selectArgs={};previousValue=selectedValue;selectArgs.id="frm_field_select_"+autoId();if(isSort)selectArgs.onchange=function(){if("rand"===this.value||"rand"===previousValue)jQuery(this).toggleClass("frm-random-order-option","rand"===this.value);previousValue=this.value};else selectArgs.onchange=function(){var newValueInput;
if("is_draft"===this.value||"is_draft"===previousValue){newValueInput=getFilterValueInput(this.value,valueInput.value);jQuery(valueInput).replaceWith(newValueInput);valueInput=newValueInput}if(frmViewsEditorInfo.statusFieldId===parseInt(this.value)||frmViewsEditorInfo.statusFieldId===parseInt(previousValue)){newValueInput=getFilterValueInput(this.value,valueInput.value);jQuery(valueInput).replaceWith(newValueInput);valueInput=newValueInput}if(fieldIsADateField(this.value))setupDateFilter(valueInput);
else if(fieldIsADateField(previousValue))removeDateFilter(valueInput);previousValue=this.value};output=select([option("",__("Select Field","formidable-views"))].concat(pullOptionsFrom("frm_field_select_template",selectedValue)),selectArgs);if(isSort)adjustFieldSelectForSort(output,selectedValue);output.classList.add("frm-field-select");return output}function adjustFieldSelectForSort(fieldSelect,selectedValue){fieldSelect.querySelector('option[value="post_id"]').remove();fieldSelect.querySelector('option[value="parent_item_id"]').remove();
fieldSelect.querySelector('option[value="ip"]').remove();fieldSelect.appendChild(option("rand",__("Random","formidable-views"),"rand"===selectedValue));if("rand"===selectedValue)fieldSelect.classList.add("frm-random-order-option")}function setupDateFilter(valueInput){var $valueInput,dateTooltip;if(valueInput.classList.contains("frm-leave-room-for-tooltip"))return;$valueInput=jQuery(valueInput);$valueInput.addClass("frm-leave-room-for-tooltip");dateTooltip=getTooltipTrigger(__("Date options: 'NOW' or a date in yyyy-mm-dd format.",
"formidable-views"));dateTooltip.style.width="25px";$valueInput.before(dateTooltip);jQuery(dateTooltip).on("mouseenter.frm",function(){jQuery(this).off("mouseenter.frm");jQuery(this).tooltip("show")})}function removeDateFilter(valueInput){var $valueInput=jQuery(valueInput);$valueInput.removeClass("frm-leave-room-for-tooltip");$valueInput.prev(".frm_tooltip_icon").remove()}function fieldIsADateField(fieldId){return-1!==frmViewsEditorInfo.dateFieldIds.indexOf(fieldId)}function getOperatorSelect(selectedValue){var output;
if("undefined"===typeof selectedValue)selectedValue="=";else selectedValue=selectedValue.replace(/&gt;/g,">").replace(/&lt;/g,"<");output=select([option("=",__("is equal to","formidable-views"),"="===selectedValue),option("!=",__("is NOT equal to","formidable-views"),"!="===selectedValue),option(">",__("greater than","formidable-views"),">"===selectedValue),option("<",__("less than","formidable-views"),"<"===selectedValue),option(">=",__("greater than or equal to","formidable-views"),">="===selectedValue),
option("<=",__("less than or equal to","formidable-views"),"<="===selectedValue),option("LIKE",__("like","formidable-views"),"LIKE"===selectedValue),option("not LIKE",__("NOT like","formidable-views"),"not LIKE"===selectedValue),option("LIKE%",__("starts with","formidable-views"),"LIKE%"===selectedValue),option("%LIKE",__("ends with","formidable-views"),"%LIKE"===selectedValue),option("group_by",__("unique (get oldest entries)","formidable-views"),"group_by"===selectedValue),option("group_by_newest",
__("unique (get newest entries)","formidable-views"),"group_by_newest"===selectedValue)]);output.classList.add("frm-operator-select");return output}function getFilterEntriesModalFooter(modalId){return div({children:[button({text:__("Update view","formidable-views"),id:"frm_update_filter_entries",onclickPreventDefault:function(){updateFilterSettings(getActiveFilterModalData());closeModal(modalId)}})]})}function getActiveFilterModalData(){var rowWrappers,allRowData,settings;rowWrappers=document.querySelectorAll(".frm-views-editor-filter-row-wrapper");
allRowData=[];each(rowWrappers,function(wrapper,groupIndex){var groupOr=0!==groupIndex&&"or"===jQuery(wrapper).closest(".frm-views-editor-filter-group").prev(".frm-and-or-select").val()?1:0;each(wrapper.children,function(row){allRowData.push({row:row,groupIndex:groupIndex,groupOr:groupOr})})});settings=[];each(allRowData,function(rowData){var row=rowData.row;settings.push({where:row.querySelector(".frm-field-select").value,is:row.querySelector(".frm-operator-select").value,val:row.querySelector(".frm-filter-value").value,
or:"or"===row.querySelector(".frm-and-or-select").value?1:0,group:rowData.groupIndex,group_or:rowData.groupOr})});return settings}function updateFilterSettings(settings){dataProcessor.data.filterEntries=settings;saveViewEditor();refreshActivePreviews();refreshFilterSortEntriesCounter("filterEntries")}function refreshActivePreviews(){refreshLayoutBuilderArea();if(onListingTab()){redrawBeforeAfterContent("before");redrawBeforeAfterContent("after")}}function refreshFilterSortEntriesCounter(key){var id=
"frm_"+key+"_counter";redraw(document.getElementById(id),getFilterSortCounter(key))}function onSortEntriesClick(){var modalId="frm_sort_entries_modal";maybeCreateModal({id:modalId,title:__("Sort entries","formidable-views"),content:getSortEntriesModalContent(),footer:getSortEntriesModalFooter(modalId)})}function getSortEntriesModalContent(){return dataProcessor.placeholder("sortEntries",function(sortSettings){var entries=sortSettings.length?sortSettings:[{}];return repeatRows("sort",entries,getSortEntriesModalRow)})}
function repeatRows(type,items,rowCallback,key){var rowWrapperId,addCallback,addButtonsToRow;if("undefined"===typeof key)key=type;rowWrapperId="frm_"+key+"_rows";addCallback=function(){var row,currentIndex,filter;row=document.getElementById(rowWrapperId);currentIndex=row.children.length;filter={};if("filter"===type)filter.or="or"===row.firstChild.querySelector(".frm-and-or-select").value;row.appendChild(addButtonsToRow(rowCallback(filter,currentIndex)))};addButtonsToRow=function(row){row.appendChild(div({class:"frm-minus-button-wrapper",
child:div({icon:"frm_row_minus_circle_icon",id:"frm_"+key+"_minus_"+autoId(),onclick:getRepeatRowOnMinusClickListener(type,row,addCallback)})}));recenterModal("frm_"+type+"_entries_modal");return row};return div({children:[div({id:rowWrapperId,class:"frm-views-editor-"+type+"-row-wrapper",children:map(items,function(current,currentIndex){return addButtonsToRow(rowCallback(current,currentIndex))})}),div({margin:"20px 0 0",child:a({id:"frm_"+key+"_rows_add_filter",onclickPreventDefault:addCallback,
children:[span({icon:"frm_row_plus_circle_icon",margin:"0 5px 0 0"}),span({text:getAddConditionTriggerText(type)})]})})]})}function getRepeatRowOnMinusClickListener(type,row,addCallback){if("filter"===type)return function(){var $filterGroup=jQuery(row).closest(".frm-views-editor-filter-group");if(1===row.parentNode.children.length)$filterGroup.find("[id^=frm_delete_group_]").click();else{row.remove();updateTargetNestedAndOrSelect($filterGroup)}recenterModal("frm_"+type+"_entries_modal")};return function(){var isLastRow=
jQuery(row).siblings().length===0;row.remove();if(isLastRow)addCallback();recenterModal("frm_"+type+"_entries_modal")}}function updateTargetNestedAndOrSelect($filterGroup){var targetSelect=$filterGroup.find(".frm-and-or-select").get(1);if("undefined"!==typeof targetSelect){targetSelect.classList.add("frm-target-and-or-select");targetSelect.disabled=false}}function getAddConditionTriggerText(key){if("filter"===key)return __("Add filter","formidable-views");return __("Add row","formidable-views")}function getSortEntriesModalRow(sort){return div({margin:"10px 0",
children:[getFieldSelect(sort.by),getOrderSelect(sort.order)]})}function getOrderSelect(selectedValue){var output;if("undefined"===typeof selectedValue)selectedValue="";output=select([option("ASC",__("Ascending","formidable-views"),"ASC"===selectedValue),option("DESC",__("Descending","formidable-views"),"DESC"===selectedValue)]);output.classList.add("frm-order-select");return output}function getSortEntriesModalFooter(modalId){return div({children:[button({text:__("Update view","formidable-views"),
id:"frm_update_sort_entries",onclickPreventDefault:function(){updateSortSettings(getActiveSortModalData());closeModal(modalId)}})]})}function getActiveSortModalData(){var settings=[];each(document.getElementById("frm_sort_rows").children,function(row){settings.push({order:row.querySelector(".frm-order-select").value,by:row.querySelector(".frm-field-select").value})});return settings}function updateSortSettings(settings){dataProcessor.data.sortEntries=settings;saveViewEditor();refreshLayoutBuilderArea();
refreshFilterSortEntriesCounter("sortEntries")}function onManageTableColumnsClick(){maybeCreateModal({id:"frm_manage_table_columns_modal",title:__("Manage table columns","formidable-views"),content:getManageTableColumnsContent(),footer:getManageTableColumnsFooter()})}function getManageTableColumnsContent(){return div({padding:"20px",child:div({children:[getTableSelectAllAndSearchOptions(),getColumnOptionsGroup(__("Selected fields","formidable-views"),getSelectedColumnOptions()),getColumnOptionsGroup(__("Unselected fields",
"formidable-views"),getUnselectedColumnOptions())]})})}function getColumnOptionsGroup(labelText,options){if(!options.length)return emptyNode();return div({margin:"0 0 10px 0",class:"frm-"+labelText.toLowerCase().replace(" ","-")+"-options-group",children:[div({margin:"0 0 5px 0",text:labelText,fontSize:"15px"}),getTableOptionHtmlFromData(options)]})}function getSelectedColumnOptions(){var columnOptions,content;columnOptions=[];content=getActivePageContent();each(content,function(data){var shortcode=
checkTableDataForShortcode(data.content);if(false!==shortcode)columnOptions.push({label:shortcode.label,value:data.box,checked:true})});return columnOptions}function getTableColumnOptionsFromServer(){post({action:"frm_views_get_table_column_options",form:frmViewsEditorViewData.formId,nonce:frmGlobal.nonce},function(data){state.tableColumnOptions=data.options})}function getTableOptionHtmlFromData(options){return div({class:["frm_grid_container","frm-table-options-container"],children:map(options,function(optionInfo){var checkboxId,
checkboxClasses,label;checkboxId="frm_table_option_checkbox_"+autoId();label=tag("label",{text:optionInfo.label,for:checkboxId});checkboxClasses=["frm_half","frm-new-table-view-option"];if(optionInfo.checked)checkboxClasses.push("frm-selected-table-view-option");return div({class:checkboxClasses,children:[getTableOptionCheckbox(optionInfo.value,checkboxId,optionInfo.checked),label]})})})}function getUnselectedColumnOptions(){var filteredOptions=[];each(state.tableColumnOptions,function(option){var expectedShortcode,
checked;expectedShortcode=convertTableOptionKeyToShortcode(option.value);checked=checkTableDataForShortcode(expectedShortcode);if(false===checked)filteredOptions.push(option)});return filteredOptions}function convertTableOptionKeyToShortcode(optionKey){var split;if(-1!==optionKey.indexOf(":")){split=optionKey.split(":");if(2===split.length)return"["+split[0]+" show="+split[1]+"]"}return"["+convertTableOptionKeyToShortcodeKey(optionKey)+"]"}function checkTableDataForShortcode(shortcode){var content,
length,index,valueKey,split,optionsLength,optionIndex,firstLabelPart;content=getActivePageContent();length=content.length;for(index=0;index<length;++index){if(shortcode!==content[index].content)continue;if(-1!==content[index].content.indexOf("show=")){valueKey=content[index].content.replace(" show=",":").replace("[","").replace("]","");split=valueKey.split(":");if(2===split.length){optionsLength=state.tableColumnOptions.length;for(optionIndex=0;optionIndex<optionsLength;++optionIndex)if(valueKey===
state.tableColumnOptions[optionIndex].value){firstLabelPart=state.tableColumnOptions[optionIndex].label.split(":")[0];return{label:firstLabelPart+": "+content[index].name}}}}return{label:content[index].name}}return false}function convertTableOptionKeyToShortcodeKey(option){switch(option){case "created_at":return"created-at";case "updated_at":return"updated-at";case "item_key":return"key"}return option}function getTableOptionCheckbox(value,checkboxId,checked){var checkbox=tag("input");checkbox.id=
checkboxId;checkbox.setAttribute("type","checkbox");checkbox.value=value;checkbox.checked=checked;return checkbox}function handleTableOptionSelect(){jQuery(this).closest(".frm-new-table-view-option").toggleClass("frm-selected-table-view-option",this.checked)}function setupTableColumnDrag(){jQuery("#frm_layout_builder_area th").draggable({helper:function(){var helper,$helper;helper=div({class:"frm-table-column-helper",html:this.querySelector("span").innerHTML});$helper=jQuery(helper);$helper.width(jQuery(this).outerWidth());
$helper.height(jQuery(this).outerHeight());$helper.css("padding-left",jQuery(this).css("padding-left"));$helper.css("padding-top",jQuery(this).css("padding-top"));return $helper},revert:moveColumnOnColumnDragRevert,delay:10,handle:".frm-table-header-drag-handle",drag:adjustPositionOfDragMarkerOnMouseMove,start:function(){document.body.classList.add("frm-dragging-table-column")},stop:function(){document.body.classList.remove("frm-dragging-table-column")}})}function moveColumnOnColumnDragRevert(){var dragMarker=
getDragMarker(),dragMarkerLeft=jQuery(dragMarker).offset().left,previousIndex=jQuery(this).index(),index=getIndexOfDragMarker(dragMarkerLeft),boxId=parseInt(jQuery(this).attr("data-box-id"));if(index>previousIndex)--index;moveColumn(boxId,index);refreshLayoutBuilderArea();return false}function adjustPositionOfDragMarkerOnMouseMove(event){adjustPositionOfDragMarker(event.clientX)}function adjustPositionOfDragMarker(x){var dragMarker,index,thAtIndex,headers,wrapperLeft,lastHeader,$lastHeader;dragMarker=
getDragMarker();index=getIndexOfDragMarker(x);headers=document.getElementById("frm_view_editor_preview_area").querySelectorAll("th");wrapperLeft=jQuery(".frm-view-editor-entries-wrapper").offset().left;if(index===headers.length){lastHeader=headers[headers.length-1];$lastHeader=jQuery(lastHeader);dragMarker.style.left=$lastHeader.offset().left-wrapperLeft+$lastHeader.outerWidth()+"px"}else{thAtIndex=headers[index];dragMarker.style.left=jQuery(thAtIndex).offset().left-wrapperLeft+"px"}}function getIndexOfDragMarker(dragMarkerLeft){var returnIndex,
headers,length,index,th,$th,thLeft;headers=document.getElementById("frm_view_editor_preview_area").querySelectorAll("th");length=headers.length;returnIndex=0;for(index=length-1;index>=0;--index){th=headers[index];$th=jQuery(th);thLeft=$th.offset().left;if(dragMarkerLeft>thLeft){returnIndex=index;if(dragMarkerLeft>thLeft+$th.outerWidth()/2)returnIndex=index+1;break}}return returnIndex}function getDragMarker(){var dragMarker=document.getElementById("frm_table_column_drag_marker");if(null===dragMarker){dragMarker=
div({id:"frm_table_column_drag_marker"});dragMarker.style.height=jQuery(document.getElementById("frm_view_editor_preview_area").querySelector("th")).outerHeight()-6+"px";document.querySelector(".frm-view-editor-entries-wrapper").appendChild(dragMarker)}return dragMarker}function removeDragMarker(){var dragMarker=document.getElementById("frm_table_column_drag_marker");if(null!==dragMarker)dragMarker.remove()}function addHoveringOverTdCellClassOnMouseEnter(){var index,th;index=jQuery(this).index();
jQuery(".frm-hovering-over-td-cell").removeClass("frm-hovering-over-td-cell");th=jQuery(this).closest("table").find("th").get(index);th.classList.add("frm-hovering-over-td-cell");jQuery(document).off("mouseover","#view-editor",removeHoveringOverTdCellClassEverywhere);jQuery(document).on("mouseover","#view-editor",removeHoveringOverTdCellClassEverywhere)}function removeHoveringOverTdCellClassEverywhere(event){var target=pullOriginalTargetFromEvent(event);if(!jQuery(target).closest("tbody").length){jQuery(".frm-hovering-over-td-cell").removeClass("frm-hovering-over-td-cell");
jQuery(document).off("mouseover","#view-editor",removeHoveringOverTdCellClassEverywhere)}}function adjustTableColumnCategoryVisibilityOnSearch(){each(document.querySelectorAll(".frm-selected-fields-options-group, .frm-unselected-fields-options-group"),function(group){var categoryHasVisibleOptions=group.querySelectorAll(".frm-new-table-view-option:not(.frm_hidden)").length>0;group.classList.toggle("frm_hidden",!categoryHasVisibleOptions)})}function toggleColumnRenameOnColumnLabelClick(){var tableHeader=
this.closest("th");tableHeader.querySelector(".frm-table-header-gear").click();focusTableColumnNameInput()}function focusTableColumnNameInput(){document.getElementById("frm_table_column_dropdown").querySelector("input[id^=frm_column_name_]").focus()}function getManageTableColumnsFooter(){return div({child:button({text:__("Update view","formidable-views"),id:"frm_update_table_columns",onclickPreventDefault:onManageTableColumnsUpdateClick}),position:"relative"})}function onManageTableColumnsUpdateClick(){var removedBoxIds,
addedFieldIds,refresh;removedBoxIds=getRemovedBoxIds();addedFieldIds=getAddedFieldIds();if(addedFieldIds.length||removedBoxIds.length){if(addedFieldIds.length)addValuesToTableData(addedFieldIds);refresh=true;if(removedBoxIds.length){removeValuesFromTableData(removedBoxIds);refresh=!maybeSetTablePlaceholder()}if(refresh)refreshLayoutBuilderArea();saveViewEditor()}closeModal("frm_manage_table_columns_modal")}function maybeSetTablePlaceholder(){var updated,layoutBuilderArea;updated=false;if(0===getActivePageContent().length){layoutBuilderArea=
document.getElementById("frm_layout_builder_area");layoutBuilderArea.innerHTML="";layoutBuilderArea.appendChild(getListingPagePlaceholderForTableTypes());updated=true}return updated}function addValuesToTableData(valuesAdded){var newPageContent,newLayoutData;newPageContent=deepClone(getActivePageContent());newLayoutData=deepClone(getActiveLayoutData());each(valuesAdded,function(valueToAdd){var newBoxId;newBoxId=getBoxAutoId();newLayoutData=maybeSetupTableLayout(newLayoutData);newLayoutData[0].boxes.push({id:newBoxId});
if(""===newPageContent)newPageContent=[];newPageContent.push({box:newBoxId,content:valueToAdd,name:getTableOptionLabelFromShortcodeValue(valueToAdd)})});updateActivePageContent(newPageContent,false);dataProcessor.data[state.activeTab+"Layout"]=newLayoutData;preventUnsavedChanges()}function maybeSetupTableLayout(layout){if(""===layout){layout=[];layout.push(getBasicEmptyRowLayout())}return layout}function getBasicEmptyRowLayout(){return{id:0,layout:1,boxes:[]}}function getTableOptionLabelFromShortcodeValue(shortcodeValue){var strippedValue,
isDynamicOption,length,index;strippedValue=shortcodeValue.substr(1,shortcodeValue.length-2);strippedValue=shortcodeValueBackToOptionKey(strippedValue);isDynamicOption=-1!==strippedValue.indexOf("show=");if(isDynamicOption)strippedValue=strippedValue.replace(" show=",":");length=state.tableColumnOptions.length;for(index=0;index<length;++index)if(strippedValue===state.tableColumnOptions[index].value){if(isDynamicOption)return state.tableColumnOptions[index].label.split(": ")[1];return state.tableColumnOptions[index].label}return shortcodeValue}
function shortcodeValueBackToOptionKey(shortcodeValue){switch(shortcodeValue){case "created-at":return"created_at";case "updated-at":return"updated_at";case "key":return"item_key"}return shortcodeValue}function removeValuesFromTableData(valuesRemoved){var newPageContent,newLayoutData,boxIdsToRemove,length,index,removeThisValue;newPageContent=deepClone(getActivePageContent());newLayoutData=deepClone(getActiveLayoutData());boxIdsToRemove=[];length=newPageContent.length;for(index=length-1;index>=0;--index){removeThisValue=
-1!==valuesRemoved.indexOf(newPageContent[index].box);if(removeThisValue){boxIdsToRemove.push(newPageContent[index].box);newPageContent.splice(index,1)}}updateActivePageContent(newPageContent,false);newLayoutData=maybeSetupTableLayout(newLayoutData);newLayoutData[0].boxes=newLayoutData[0].boxes.filter(function(x){return-1===boxIdsToRemove.indexOf(x.id)});dataProcessor.data[state.activeTab+"Layout"]=newLayoutData;preventUnsavedChanges()}function getRemovedBoxIds(){var removedBoxIds=[];each(document.querySelectorAll(".frm-selected-fields-options-group .frm-new-table-view-option input"),
function(input){if(!input.checked)removedBoxIds.push(parseInt(input.value))});return removedBoxIds}function getAddedFieldIds(){var addedBoxIds=[];each(document.querySelectorAll(".frm-unselected-fields-options-group .frm-new-table-view-option input"),function(input){if(input.checked)addedBoxIds.push(convertTableOptionKeyToShortcode(input.value))});return addedBoxIds}function onLayoutBuilderToggleClick(){triggerLayoutBuilderModal()}function getLayoutBuilderArea(){return dataProcessor.placeholder(state.activeTab+
"Content",processActivePageContent)}function processActivePageContent(){return div({id:"frm_layout_builder_area",class:"frm-education-wrapper",child:shouldActivePageUsePlaceholder()?getActivePagePlaceholder():getLayoutBuilderAreaWorkingSpace()})}function shouldActivePageUsePlaceholder(){var hasData;if(isTableType()){if(!onListingTab())return!listingPageContentContainsALinkToDetailPage()}else if(!isGridType())return false;hasData=function(keySuffix){var data=dataProcessor.data[state.activeTab+keySuffix];
if("Content"===keySuffix&&Array.isArray(data)){if(0===data.length)return false;if(data.length>1)return true;if("undefined"!==typeof data[0].rows&&data[0].rows.length)return true;return!!data[0].content}return!!data};return!hasData("Layout")&&!hasData("Content")}function getActivePagePlaceholder(){if(onListingTab())return getListingPagePlaceholderBuilderArea();if(isTableType()&&!listingPageContentContainsALinkToDetailPage())return getNotYetDynamicDescription();return getDetailPagePlaceholderBuilderArea()}
function getLayoutBuilderAreaWorkingSpace(){if(onListingTab())return getListingPageWorkingSpace();return getDetailPageWorkingSpace()}function getListingPageWorkingSpace(){return dataProcessor.placeholder("listingLayout",function(layoutData){var entries,isEmpty,boxData,tableClasses,children,args,output;entries=getEntries();isEmpty=!entries.length;if(isEmpty)entries=[{},{},{},{},{}];boxData={id:0,rows:""!==layoutData?layoutData:[]};if(isTableType()){children=map(entries,function(entry,index){return getLayoutFunction({isSimple:0!==
index,entryIndex:index})(boxData).firstChild});children=getTableHeaders(boxData).concat([tag("tbody",{children:children})]);tableClasses=["with_frm_style"];if(""!==dataProcessor.data.tableRowStyle)jQuery("#view-editor").one("frm-box-processor-success",function(){document.getElementById("frm_table_editor_table").classList.add(dataProcessor.data.tableRowStyle)});children=[div({id:"frm_table_editor_wrapper",child:tag("table",{id:"frm_table_editor_table",class:tableClasses,children:children})})]}else children=
map(entries,function(entry,index){var output,outputClass;outputClass=[];if(isGridType())outputClass.push(getClassForColumnCount());if(0===index)output=div({class:outputClass,position:"relative",child:getLayoutFunction()(boxData)});else{output=div({class:outputClass,child:getLayoutFunction({isSimple:true,entryIndex:index})(boxData)});output.classList.add("frm-fade-layout");if(!isGridType())output.style.marginTop="30px"}return output});args={};if(isEmpty){children.push(getNoEntriesPlaceholder());args.position=
"relative";args.class="frm-view-editor-no-entries"}else{args.class="frm-view-editor-entries-wrapper";if(isTableType())children.push(div({id:"frm-add-table-column",child:div({icon:"frm_views_editor_plus_icon",id:"frm-add-table-column-trigger",onclick:function(){var newBoxId,layout,content,box;newBoxId=getBoxAutoId();layout=getActiveLayoutData();layout=maybeSetupTableLayout(layout);layout[0].boxes.push({id:newBoxId});content=getActivePageContent();box={box:newBoxId,content:"",name:""};content.push(box);
preventUnsavedChanges();refreshLayoutBuilderArea();jQuery("#view-editor").one("frm-box-processor-success",autoFocusColumnNameInputOnNewColumn)}})}));if(isGridType()||isTableType())args.class=maybeAddCustomClasses([args.class,"frm_grid_container"])}args.children=children;output=div(args);if(isGridType())output.style["grid-gap"]=dataProcessor.data.gridRowGap+"px "+dataProcessor.data.gridColumnGap+"%";return output})}function maybeAddCustomClasses(classes){var customClasses=dataProcessor.data.customClasses;
if(customClasses)Array.prototype.push.apply(classes,reduceCustomClasses(customClasses));return classes}function autoFocusColumnNameInputOnNewColumn(){var newTableHeader=document.getElementById("frm_table_editor_table").querySelector("th:last-child");newTableHeader.querySelector(".frm-table-header-gear").click();focusTableColumnNameInput()}function getTableHeaders(boxData){var boxes,headers;boxes=[];if(boxData.rows.length&&"undefined"!==typeof boxData.rows[0].boxes)boxes=boxData.rows[0].boxes;headers=
[];each(boxes,function(box,index){var pageContent,name,namePlaceholder,th;pageContent=searchPageContentForBoxId(box.id);if("undefined"!==typeof pageContent.name){name=pageContent.name;namePlaceholder=span({html:name});if(-1!==name.indexOf("["))jQuery("#view-editor").one("frm-box-processor-success",function(){var processedNameIsSet="undefined"!==typeof boxProcessor.state.details.names[box.id];if(processedNameIsSet)namePlaceholder.innerHTML=boxProcessor.state.details.names[box.id]})}else namePlaceholder=
span();th=tag("th",{children:[namePlaceholder,span({class:"frm-table-header-controls",children:[span({icon:"frm_views_editor_table_header_gear",id:"frm_table_header_gear_"+box.id,class:"frm-table-header-gear",onclick:createTableHeaderGearClickHandler(box.id)}),span({icon:"frm_views_editor_vertical_drag",class:"frm-table-header-drag-handle"})]})]});if(boxes.length>4&&index<3)th.classList.add("frm-align-dropdown-left");th.setAttribute("data-box-id",box.id);headers.push(th)});return[tag("thead",{child:tag("tr",
{children:headers})})]}function createTableHeaderGearClickHandler(boxId){return function(){var $th,popup,dropdown,dropdownWidth,dropdownLeft,leftLimit;$th=jQuery(this).closest("th");if($th.hasClass("frm-dropdown-open"))return;popup=document.getElementById("frm_table_column_dropdown");if(null!==popup)popup.remove();removeAllTableHeaderDropdowns();$th.addClass("frm-dropdown-open");dropdown=getTableColumnDropdown(boxId);dropdownLeft=jQuery(this).offset().left;dropdownWidth=320;leftLimit=jQuery(window).width()-
dropdownWidth;if(dropdownLeft>leftLimit)dropdownLeft-=dropdownWidth;dropdown.style.left=dropdownLeft+"px";dropdown.style.top=jQuery(this).offset().top+"px";document.getElementById("frm_layout_builder_area").appendChild(dropdown);jQuery(document).on("click",removeDropdownsIfClickingOutsideofDropdownArea)}}function pullOriginalTargetFromEvent(event){var originalEvent=event.originalEvent;return originalEvent.target||originalEvent.srcElement||originalEvent.originalTarget}function removeDropdownsIfClickingOutsideofDropdownArea(event){var target,
shouldRemove;target=pullOriginalTargetFromEvent(event);shouldRemove=true;if(jQuery(target).hasClass("frm-table-header-gear"))shouldRemove=false;else if(jQuery(target).closest("#frm_table_column_dropdown").length)shouldRemove=false;else if("span"===target.nodeName.toLowerCase()&&"th"===target.parentNode.nodeName.toLowerCase()&&null!==target.closest("#frm_table_editor_table"))shouldRemove=false;if(shouldRemove)removeAllTableHeaderDropdowns()}function removeAllTableHeaderDropdowns(){jQuery(".frm-dropdown-open").removeClass("frm-dropdown-open");
jQuery("#frm_table_column_dropdown").remove();jQuery(document).off("click",removeDropdownsIfClickingOutsideofDropdownArea)}function getTableColumnDropdown(boxId){var columnNameLabel,boxData;columnNameLabel=tag("label",{text:__("Column Name","formidable-views"),for:"frm_column_name_"+boxId});boxData=searchPageContentForBoxId(boxId);return div({id:"frm_table_column_dropdown",children:[columnNameLabel,getTableColumnNameInput(boxId,boxData),getAddLinkToDetailsPageToggle(boxId,boxData),separator(),tag("label",
{text:__("Actions","formidable-views")}),getColumnActionOptions(boxId)]})}function getColumnActionOptions(boxId){return div({class:"frm-column-action-options",children:[getDuplicateTableColumnOption(boxId),getDeleteTableColumnOption(boxId)]})}function getAddLinkToDetailsPageToggle(boxId,boxData){var checkbox=input({id:"frm_details_link_toggle_"+boxId,onchange:function(){boxData.detailsLink=this.checked?1:0;refreshActivePreviews()},type:"checkbox",class:"frm_hidden"});checkbox.checked="undefined"!==
typeof boxData.detailsLink&&1===boxData.detailsLink?true:false;return tag("label",{class:"frm_switch_block",margin:"5px 0",children:[checkbox,span({class:"frm_switch",child:span({class:"frm_slider"})}),span({class:["frm_on_label","frm_switch_opt"],fontSize:"14px",color:"rgba(40, 47, 54, 0.6)",text:__("Add link to details page","formidable-views")})]})}function getTableColumnNameInput(boxId,boxData){return input({id:"frm_column_name_"+boxId,value:boxData.name,onchange:getColumnNameChangeHandler(boxId)})}
function getColumnNameChangeHandler(boxId){return function(){var boxData=searchPageContentForBoxId(boxId);boxData.name=this.value;preventUnsavedChanges();jQuery(document.getElementById("frm_table_editor_table").querySelector("th.frm-dropdown-open")).children("span").first().html(this.value)}}function getDuplicateTableColumnOption(boxId){return getTableColumnOption(boxId,"duplicate",__("Duplicate","formidable-views"),getDuplicateTableColumnHandler)}function getDeleteTableColumnOption(boxId){return getTableColumnOption(boxId,
"delete",__("Delete","formidable-views"),getDeleteTableColumnHandler)}function getTableColumnOption(boxId,key,title,getHandler){return div({id:"frm_"+key+"_table_column_"+boxId,class:"frm-duplicate-table-column",onclick:getHandler(boxId),children:[span({icon:"frm_views_editor_"+key+"_column_icon",margin:"0 5px 0 0"}),span({text:title})]})}function getDuplicateTableColumnHandler(boxId){return function(){var newBoxId,layout,thisIndex,length,index,newBox,boxData,content,box;newBoxId=getBoxAutoId();layout=
getActiveLayoutData();layout=maybeSetupTableLayout(layout);thisIndex=-1;length=layout[0].boxes.length;for(index=0;index<length;++index)if(boxId===layout[0].boxes[index].id){thisIndex=index;break}newBox={id:newBoxId};layout[0].boxes.splice(thisIndex,0,newBox);boxData=searchPageContentForBoxId(boxId);box={box:newBoxId,content:boxData.content,name:boxData.name};content=getActivePageContent();content.push(box);preventUnsavedChanges();refreshLayoutBuilderArea()}}function getDeleteTableColumnHandler(boxId){return function(){var newPageContent,
newLayoutData,length,index;newPageContent=deepClone(getActivePageContent());newLayoutData=deepClone(getActiveLayoutData());length=newPageContent.length;for(index=length-1;index>=0;--index)if(boxId===newPageContent[index].box)newPageContent.splice(index,1);newLayoutData=maybeSetupTableLayout(newLayoutData);newLayoutData[0].boxes=newLayoutData[0].boxes.filter(function(x){return boxId!==x.id});updateActivePageContent(newPageContent,false);dataProcessor.data[state.activeTab+"Layout"]=newLayoutData;preventUnsavedChanges();
if(!maybeSetTablePlaceholder())refreshLayoutBuilderArea()}}function moveColumn(boxId,toIndex){var newLayoutData,boxes,length,index,toIndex;newLayoutData=deepClone(getActiveLayoutData());newLayoutData=maybeSetupTableLayout(newLayoutData);boxes=newLayoutData[0].boxes;length=boxes.length;for(index=0;index<length;++index)if(boxId===boxes[index].id){moveArrayValue(boxes,index,toIndex);break}dataProcessor.data[state.activeTab+"Layout"]=newLayoutData}function moveArrayValue(array,from,to){var element=array[from];
array.splice(from,1);array.splice(to,0,element)}function reduceCustomClasses(rawCustomClasses){var initialValue=[];return rawCustomClasses.split(" ").reduce(customClassReducer,initialValue)}function customClassReducer(total,customClass){var trimmedClass=customClass.trim();if(trimmedClass.length)total.push(trimmedClass);return total}function getEntries(){var size,index,entries=[];if(boxProcessor.state.hasData&&!boxProcessor.state.data.length)size=0;else if(dataProcessor.data.pageSize)if(dataProcessor.data.limit&&
dataProcessor.data.limit<dataProcessor.data.pageSize)size=dataProcessor.data.limit;else size=dataProcessor.data.pageSize;else if(dataProcessor.data.limit)size=dataProcessor.data.limit;else size=10;if(size>frmViewsEditorInfo.previewLimit)size=frmViewsEditorInfo.previewLimit;for(index=0;index<size;index++)entries.push({});return entries}function getNoEntriesPlaceholder(){setTimeout(placeNoEntriesPlaceholderBelowTheFirstEntry,0);return div({id:"frm_no_entries_placeholder",children:[div({class:"frm-placeholder-description-title",
text:__("This form has no entries","formidable-views")}),div({text:__("You can still add fields to this view. After receiving form submissions entries will be displayed here","formidable-views"),margin:"0 0 30px 0"}),getSVG("repeatable-layout"),getStartAddingContentButton(),div({margin:"15px 0 30px",children:[document.createTextNode(__("Or select another form with entries in the Advanced Settings","formidable-views"))]})]})}function placeNoEntriesPlaceholderBelowTheFirstEntry(){var top,$row;if(isTableType()){$row=
jQuery(getFirstTablePreviewRow());top=$row.position().top+$row.outerHeight()}else top=jQuery(document.querySelector(".frm-view-editor-no-entries").firstChild).outerHeight()+10;document.getElementById("frm_no_entries_placeholder").style.top=top+"px"}function getFirstTablePreviewRow(){return document.getElementById("frm_table_editor_table").querySelector("tbody tr")}function getStartAddingContentButton(){var output=button({id:"frm_start_adding_content_button",onclickPreventDefault:onStartAddingContentClick,
text:__("Start adding content","formidable-views")});output.style.borderRadius="5px";return output}function onStartAddingContentClick(){window.location.href=frmViewsEditorInfo.startAddingContentUrl.replace(/&#038;/g,"&").replace("&form=0","&form="+frmViewsEditorViewData.formId)}function getFirstAvailableBoxDataFromRows(rows){var index,length,row,boxData;length=rows.length;for(index=0;index<length;++index){row=rows[index];boxData=getFirstAvailableBoxDataFromBoxes(row.boxes);if(false!==boxData)return boxData}return false}
function getFirstAvailableBoxDataFromBoxes(boxes){var index,length,box,boxData;length=boxes.length;for(index=0;index<length;++index){box=boxes[index];if("undefined"===typeof box.rows)return box;boxData=getFirstAvailableBoxDataFromRows(box.rows);if(false!==boxData)return boxData}return false}function getDetailPageWorkingSpace(){return dataProcessor.placeholder("detailLayout",function(layoutData){return div({class:"frm-views-single-entry-wrapper",position:"relative",child:getLayoutFunction()({id:0,
rows:layoutData})})})}function getListingPagePlaceholderBuilderArea(){if(isGridType())return getListingPagePlaceholderForGridTypes();return getListingPagePlaceholderForTableTypes()}function getListingPagePlaceholderForGridTypes(){return div({class:["frmcenter","frm-working-space-border"],children:[getRepeatableLayoutDescription(),getLayoutBuilderPlaceholderActions()]})}function getListingPagePlaceholderForTableTypes(){return div({class:["frmcenter","frm-working-space-border"],children:[div({class:"frm-placeholder-description-title",
text:__("This table has no columns set","formidable-views")}),div({text:__('Click "Manage columns" to start adding columns.',"formidable-views"),margin:"0 0 30px 0"})]})}function getRepeatableLayoutDescription(title,description){return div({children:[div({class:"frm-placeholder-description-title",text:"undefined"!==typeof title?title:__("Build your repeatable layout","formidable-views")}),div({text:"undefined"!==typeof description?description:__("Create a layout to present your data by clicking or dragging the rows above",
"formidable-views"),margin:"0 0 30px 0"}),getSVG("repeatable-layout")]})}function getLayoutBuilderPlaceholderActions(){var callToActionButton;if(onListingTab()||theSingleEntryDetailViewIsActive())callToActionButton=getLayoutBuilderButton();else callToActionButton=getAddDetailLinkButton();return div({children:[callToActionButton,getOrAction()]})}function theSingleEntryDetailViewIsActive(){return isSingleEntryType()||viewIsDynamic()}function getOrAction(){if(onListingTab()||theSingleEntryDetailViewIsActive())return div({margin:"15px 0 30px",
children:[document.createTextNode(__("Or","formidable-views")),document.createTextNode(" "),a({text:__("start adding content","formidable-views"),id:"frm_views_start_adding_content",onclickPreventDefault:setSingleColumnLayout}),document.createTextNode(" "),document.createTextNode(__("into a single column view","formidable-views"))]});return div({margin:"15px 0 30px",children:[document.createTextNode(__("Or","formidable-views")),document.createTextNode(" "),a({text:__("continue anyway","formidable-views"),
id:"frm_continue_anyway",onclickPreventDefault:continueAnyway}),document.createTextNode(".")]})}function continueAnyway(){triggerLayoutBuilderModal()}function getCustomLayoutDescription(forceCustomLayoutDescription){var wrapper;if(!forceCustomLayoutDescription&&!theSingleEntryDetailViewIsActive())return getNotYetDynamicDescription();wrapper=div({children:[div({class:"frm-placeholder-description-title",text:__("Build your custom layout for the page","formidable-views")}),getCheckmarkListItems([__("Drag and drop rows into working area",
"formidable-views"),__("You can drop rows in a column and build complex layouts","formidable-views")]),getCustomLayoutSVG()],margin:"0 auto",textAlign:"left"});wrapper.style.maxWidth="400px";return wrapper}function getNotYetDynamicDescription(){var wrapper=div({children:[div({class:"frm-placeholder-description-title",text:__("The single entry detail view is not active","formidable-views")}),div({text:__("This content is used to show more information about a single entry.","formidable-views")}),div({margin:"10px 0",
text:__("To use this page, include the [detaillink] shortcode in the content for All Entries.","formidable-views")})],margin:"0 auto",textAlign:"left"});wrapper.style.maxWidth="400px";return wrapper}function setSingleColumnLayout(){dataProcessor.data[state.activeTab+"Layout"]="";redraw(document.getElementById("frm_layout_builder_area"),getLayoutBuilderAreaWorkingSpace());boxProcessor.watch("addAddYourContentEducation",addAddYourContentEducation)}function getDetailPagePlaceholderBuilderArea(){var gap=
div();gap.style.height="35px";return div({class:["frmcenter","frm-working-space-border"],children:[getCustomLayoutDescription(),gap,getLayoutBuilderPlaceholderActions()]})}function getSVG(filename){var args={child:tag("img")};args.child.setAttribute("src",frmViewsEditorInfo.svgPath+filename+".svg");return div(args)}function getLayoutBuilderButton(){var output=button({id:"frm_layout_builder_button",onclickPreventDefault:onLayoutBuilderButtonClick,text:__("Layout Builder","formidable-views")});output.style.borderRadius=
"5px";return output}function getAddDetailLinkButton(){var output=button({id:"frm_add_detail_link_button",onclickPreventDefault:addDetailLink,text:__("Add detail link","formidable-views")});output.style.borderRadius="5px";return output}function addDetailLink(){var boxData=getFirstAvailableBoxDataFromRows(dataProcessor.data.listingLayout);if(false===boxData)boxData={id:0,content:dataProcessor.data.listingContent};document.getElementById("frm_views_trigger_listing_page").click();editBoxContentModal(boxData)}
function onLayoutBuilderButtonClick(){triggerLayoutBuilderModal()}function getAfterContentWrapper(){return getBeforeOrAfterContentWrapper("after")}function copyToClipboard(text){var target,copySuccess;target=input({value:text,position:"absolute"});target.style.top=0;target.style.left=0;document.body.appendChild(target);target.focus();target.select();target.setSelectionRange(0,99999);try{copySuccess=document.execCommand("copy")}catch(error){copySuccess=false}document.body.removeChild(target);return copySuccess}
function triggerLayoutBuilderModal(){var modalId="frm_layout_builder_modal";state.editingLayoutTemplate=false;state.layoutBuilderModalData=deepClone(getActiveLayoutData());resetBoxAutoId();maybeCreateModal({id:modalId,title:__("Build your layout","formidable-views"),content:getLayoutBuilderModalContent(),footer:getLayoutBuilderModalFooter(modalId)});makeLayoutTypeOptionsDraggable();makeWorkingAreaDroppable();if(!layoutDataIsAlreadySet())addLayoutBuilderModalEducation()}function resetBoxAutoId(){boxAutoId=
-1}function makeLayoutTypeOptionsDraggable(){var $options=jQuery(".frm-layout-type-option");$options.draggable({helper:"clone",revert:"invalid",delay:10});$options.on("click",handleLayoutOptionClick)}function handleLayoutOptionClick(){var layout=this.getAttribute("frm-layout");if(layoutDataIsAlreadySet())appendALayoutToLayoutBuilder(layout);else replaceLayoutBuilderPlaceholderWithASingleRowLayout(layout)}function appendALayoutToLayoutBuilder(layout){var data=deepClone(state.layoutBuilderModalData);
if("string"===typeof layout)layout=parseInt(layout,10);data.push(getRowWithBoxesForLayout(layout));setLayoutBuilderModalDataAndRedraw(data);scrollLayoutBuilderModalContainerToBottom()}function scrollLayoutBuilderModalContainerToBottom(){var container=document.getElementById("frm_layout_builder_modal_layout_container");container.scrollTop=container.scrollHeight}function replaceLayoutBuilderPlaceholderWithASingleRowLayout(layout){if("string"===typeof layout)layout=parseInt(layout,10);setLayoutBuilderModalDataAndRedraw([getRowWithBoxesForLayout(layout)])}
function addLayoutBuilderModalEducation(){maybeAppendEducation(function(){return jQuery(document.getElementById("frm_layout_builder_modal_main_area").firstChild).children().last()},function($target){appendEducationRight($target,{title:__("Build layout","formidable-views"),description:__("Drag and drop layout options to build a layout. You can also click an option to insert it.","formidable-views"),key:"build-card-layout"},function(){return{offset:0,top:3}})})}function maybeAppendEducation(targetCallback,
callback){var $target;if(frmViewsEditorInfo.showEducation){$target=targetCallback();if($target.length)callback($target)}}function appendEducationRight($target,educationDetails,positionCallback){var wrapper,positionWrapper,position,offset,top;wrapper=div({class:"frm-education-right",children:[getPulsingEducationCircle(),getEducation(educationDetails)]});if("undefined"===typeof positionCallback){offset=0;top=0}else{position=positionCallback($target);offset=position.offset;top=position.top}positionWrapper=
function(){var left=$target.position().left+$target.outerWidth()+offset;wrapper.style.left=left+10+"px"};wrapper.style.top=top+"px";positionWrapper();jQuery(window).on("resize",positionWrapper);appendEducationWrapper($target,wrapper)}function appendEducationAbove($target,educationDetails){appendEducationWrapper($target,div({class:"frm-education-above",children:[getEducation(educationDetails),getPulsingEducationCircle()]}))}function appendEducationBelow($target,educationDetails){appendEducationWrapper($target,
div({class:"frm-education-below",children:[getPulsingEducationCircle(),getEducation(educationDetails)]}))}function getPulsingEducationCircle(){return div({class:"frm_views_editor_education"})}function appendEducationWrapper($target,wrapper){var key,targetParent;key=wrapper.querySelector(".frm-education").id.replace("frm_education_","");if(-1!==state.educationThatHasBeenShown.indexOf(key))return;removeAllEducationWrappers();if($target.closest(".frm-education-wrapper").length)targetParent=$target.closest(".frm-education-wrapper").get(0);
else targetParent=$target.parent().get(0);targetParent.style.position="relative";targetParent.appendChild(wrapper);jQuery(document).on("click.frm-cancel-education",function(event){var target=event.originalEvent.originalTarget;if(target.classList.contains("frm-education")||jQuery(target).closest(".frm-education").length)return;removeAllEducationWrappers()});state.educationThatHasBeenShown.push(key)}function removeAllEducationWrappers(){jQuery(".frm-education").prev().addBack().remove();jQuery(document).off("click.frm-cancel-education")}
function getEducation(details){return div({id:"frm_education_"+details.key,class:"frm-education",children:[div({class:"frm-education-title",text:details.title}),div({class:"frm-education-description",text:details.description}),div({children:[a({class:"frm-education-continue",text:__("Close","formidable-views")})]})]})}function addAreYouReadyToAddDataEducation(){maybeAppendEducation(function(){return jQuery(document.getElementById("frm_save_layout"))},function($target){appendEducationAbove($target,
{title:__("Are you ready to add data?","formidable-views"),description:__("If you are happy with your layout, save it and start adding content to your view.","formidable-views"),key:"ready-to-add-data"})})}function addAddYourContentEducation(){maybeAppendEducation(function(){return jQuery(document.getElementById("frm_layout_builder_area").querySelectorAll(".frm-add-content-to-layout-block svg")).first()},function($target){appendEducationRight($target,{title:__("Add your content","formidable-views"),
description:__("Add data from your form to separate layout cells.","formidable-views"),key:"add-your-content"},function(){var offset,top;offset=-$target.position().left;top=$target.offset().top;if($target.closest(".frm-education-wrapper").length){offset=$target.offset().left-$target.closest(".frm-education-wrapper").offset().left-$target.position().left;top-=$target.closest(".frm-education-wrapper").offset().top}else top=10;return{offset:offset,top:top}})})}function getRowWithBoxesForLayout(layout){var row=
{id:getBoxAutoId(),layout:layout,boxes:map(getLayoutClassName(layout).split("-"),getSimpleLayoutBoxObjectWithUniqueId)};return row}function getSimpleLayoutBoxObjectWithUniqueId(){return{id:getBoxAutoId()}}function setLayoutBuilderModalDataAndRedraw(data){state.layoutBuilderModalData=data;resetBoxAutoId();redrawLayoutBuilderModalWorkingSpace();redrawLayoutBuilderFooter();makeWorkingAreaDroppable()}function makeWorkingAreaDroppable(){var modal,placeholderArea,emptyBoxes;modal=document.getElementById("frm_layout_builder_modal");
placeholderArea=modal.querySelector(".frm-working-space-border");if(null!==placeholderArea)makeDroppable(placeholderArea,handleLayoutOptionDropIntoPlaceholderArea);else{emptyBoxes=modal.querySelectorAll(".frm-layout-builder-box.frm-layout-builder-box-with-0-rows, .frm-views-droppable-placeholder");makeDroppable(emptyBoxes,handleDropIntoEmptyBox,handleDragOverEmptyBox)}}function makeDroppable(target,dropCallback,overCallback){var params={accept:".frm-layout-type-option, .frm-layout-builder-row",drop:wrapDropFunction(dropCallback)};
if("undefined"!==typeof overCallback)params.over=overCallback;jQuery(target).droppable(params)}function wrapDropFunction(callback){return function(event,ui){var draggable,layout,moveRowData,rowId;draggable=ui.draggable[0];moveRowData=false;if(draggable.classList.contains("frm-layout-builder-row"))rowId=parseInt(draggable.getAttribute("frm-row-id")),moveRowData=deleteRowFromLayoutBuilderModalData(rowId,true);layout=getLayoutFromDraggable(draggable);callback(layout,event.target,moveRowData)}}function handleLayoutOptionDropIntoPlaceholderArea(layout){replaceLayoutBuilderPlaceholderWithASingleRowLayout(layout)}
function handleDropIntoEmptyBox(layout,box,moveRowData){var orientation,boxId;if(box.classList.contains("frm-views-droppable-placeholder"))return handleLayoutOptionDropIntoPlaceholder(box,layout,moveRowData);if(boxHasReachedNestingLimit(box,layout)){removeNestingLimitWarningFromBox(box,true);return}orientation=getActiveDragOrientation(box);boxId=parseInt(box.getAttribute("frm-box-id"),10);setLayoutBuilderModalBoxLayout(boxId,layout,orientation,moveRowData)}function handleLayoutOptionDropIntoPlaceholder(box,
layout,moveRowData){var data,newRow,index,isTopLevel,targetRowId;data=Array.isArray(state.layoutBuilderModalData)?deepClone(state.layoutBuilderModalData):[];newRow=moveRowData?moveRowData:getRowWithBoxesForLayout(layout);index=jQuery(box).index();isTopLevel="frm_layout_builder_modal_working_space"===box.parentNode.id;if(isTopLevel)if(0===index)data.unshift(newRow);else data.push(newRow);else{targetRowId=parseInt(jQuery(box).prev().attr("frm-row-id"));if(moveRowData&&targetRowId===moveRowData.id)return;
insertRowAfterRowId(targetRowId,data,newRow)}setLayoutBuilderModalDataAndRedraw(data)}function insertRowAfterRowId(rowId,data,newRow){var rowIndex,boxes,boxLength,boxIndex,box;for(rowIndex=0;rowIndex<data.length;++rowIndex){if(rowId===data[rowIndex].id){data.splice(rowIndex+1,0,newRow);return true}boxes=data[rowIndex].boxes;boxLength=boxes.length;for(boxIndex=0;boxIndex<boxLength;++boxIndex){box=boxes[boxIndex];if("undefined"!==typeof box.rows&&insertRowAfterRowId(rowId,box.rows,newRow))return true}}return false}
function getActiveDragOrientation(box){var classList=box.classList;if(classList.contains("frm-add-layout-top"))return"top";if(classList.contains("frm-add-layout-bottom"))return"bottom";return"middle"}function handleDragOverEmptyBox(event,ui){var draggable,layout,box;draggable=ui.draggable[0];layout=getLayoutFromDraggable(draggable);if(false!==layout){box=event.target;handleLayoutOptionOverEmptyBox(layout,box,ui)}}function getLayoutFromDraggable(element){var layout=false;if(element.classList.contains("frm-layout-type-option"))layout=
getLayoutFromDraggableOption(element);else if(element.classList.contains("frm-layout-builder-row"))layout=getLayoutFromRow(element);return layout}function getLayoutFromDraggableOption(element){return parseInt(element.getAttribute("frm-layout"),10)}function getLayoutFromRow(rowElement){var block,classLength,index,className,isAValidLayoutClassName;block=jQuery(rowElement).children(".frm-layout-builder-block").get(0);classLength=block.classList.length;for(index=0;index<classLength;++index){className=
block.classList[index];isAValidLayoutClassName=-1!==className.indexOf("frm-layout-")&&-1===className.indexOf("builder");if(isAValidLayoutClassName)return className.replace("frm-layout-","")}return false}function handleLayoutOptionOverEmptyBox(layout,box,ui){if(boxHasReachedNestingLimit(box,layout))addNestingLimitWarningToBox(box);else handleLayoutOptionOverForValidBox(layout,box,ui)}function addNestingLimitWarningToBox(box){box.classList.add("frm-reached-nesting-limit");box.appendChild(getNestingLimitWarningIcon());
jQuery(box).one("dropout",function(){removeNestingLimitWarningFromBox(box,false)})}function getNestingLimitWarningIcon(){return div({icon:"frm_nesting_limit_lock_icon"})}function handleLayoutOptionOverForValidBox(layout,box,ui){var $box,determineBoxOrientation,draggable,temporaryBoxChild,handleLayoutOptionDragOverEmptyBox;$box=jQuery(box);if(box.classList.contains("frm-views-droppable-placeholder")){determineBoxOrientation=function(){return"middle"};temporaryBoxChild=div({class:"frm-drag-placeholder-child"})}else{draggable=
ui.draggable[0];determineBoxOrientation=createBoxOrientationFunction($box.offset().top,$box.height(),jQuery(draggable).height());temporaryBoxChild=div({class:"frm-drag-placeholder-child",padding:"5px",child:getLayoutFunction({isSimple:true})({id:0,rows:[getRowWithBoxesForLayout("1"),getRowWithBoxesForLayout(layout),getRowWithBoxesForLayout("1")]})})}box.appendChild(temporaryBoxChild);setLayoutOptionDragStateClass(box,determineBoxOrientation(ui.offset));handleLayoutOptionDragOverEmptyBox=function(dragEvent,
dragUi){setLayoutOptionDragStateClass(box,determineBoxOrientation(dragUi.offset))};ui.draggable.on("drag",handleLayoutOptionDragOverEmptyBox);jQuery(box).one("dropout",function(){ui.draggable.off("drag",handleLayoutOptionDragOverEmptyBox);box.removeChild(temporaryBoxChild)})}function boxHasReachedNestingLimit(box,layout){var layoutClass,numberOfColumnsInLayout,fullWidth,limit;if(box.classList.contains("frm-views-droppable-placeholder"))return false;layoutClass=getLayoutClassName(layout);numberOfColumnsInLayout=
layoutClass.split("-").length;fullWidth=jQuery('.frm-layout-builder-box[frm-box-id="0"]').width();limit=fullWidth/14;return jQuery(box).width()/numberOfColumnsInLayout<limit}function getNestingLimitWarning(){var body,args;body=__("You've reached the maximum level of nesting. Try to delete this box or use another one.","formidable-views");args={useClass:"frm-nesting-limit-warning",useIcon:"frm_nesting_limit_lock_icon",useCancelText:__("Got it!","formidable-views")};return getWarning(body,args)}function removeNestingLimitWarningFromBox(box,
appendWarning){box.classList.remove("frm-reached-nesting-limit");box.innerHTML="";if(appendWarning)appendToLayoutBuilderModalWorkingSpace(getNestingLimitWarning())}function setLayoutOptionDragStateClass(box,orientation){var $box=jQuery(box);$box.removeClass("frm-add-layout-top frm-add-layout-bottom frm-add-layout-middle");$box.addClass("frm-add-layout-"+orientation)}function createBoxOrientationFunction(boxTop,boxHeight,draggableHeight){var heightFraction=boxHeight*.25,halfDraggableHeight=draggableHeight/
2;return function(offset){var y=offset.top-boxTop;if(y<heightFraction-halfDraggableHeight)return"top";if(y>boxHeight-heightFraction-halfDraggableHeight)return"bottom";return"middle"}}function setLayoutBuilderModalBoxLayout(boxId,layout,orientation,moveRowData){var boxData=searchRowDataForBoxId(state.layoutBuilderModalData,boxId),newRow=moveRowData?moveRowData:getRowWithBoxesForLayout(layout);if(false!==boxData){if("middle"===orientation)boxData.rows=[newRow];else if("top"===orientation)boxData.rows=
[newRow,getRowWithBoxesForLayout(1)];else if("bottom"===orientation)boxData.rows=[getRowWithBoxesForLayout(1),newRow];redrawLayoutBuilderModalWorkingSpace()}}function searchRowDataForBoxId(rows,boxId){var rowIndex,currentRow,boxIndex,currentBox,nestedSearchResult;for(rowIndex=0;rowIndex<rows.length;++rowIndex){currentRow=rows[rowIndex];for(boxIndex=0;boxIndex<currentRow.boxes.length;++boxIndex){currentBox=currentRow.boxes[boxIndex];if(boxId===currentBox.id)return currentBox;if("undefined"!==typeof currentBox.rows){nestedSearchResult=
searchRowDataForBoxId(currentBox.rows,boxId);if(false!==nestedSearchResult)return nestedSearchResult}}}return false}function getLayoutBuilderModalContent(){return div({id:"frm_layout_builder_modal_content",class:"frm_grid_container",children:[getLayoutBuilderModalMainArea()]})}function getLayoutBuilderModalMainArea(){return div({id:"frm_layout_builder_modal_main_area",class:"frm_full",children:[getLayoutBuilderTypeOptions(),separator(),div({id:"frm_layout_builder_modal_layout_container",child:getLayoutBuilderModalWorkingSpace()})]})}
function getLayoutBuilderTypeOptions(){return div({class:"frmcenter",margin:"20px 0",children:map(Array(NUMBER_OF_LAYOUT_OPTIONS),getLayoutBuilderOptionBasedOnIndex)})}function getLayoutBuilderOptionBasedOnIndex(item,index){var layout=getLayoutClassName(index+1);return getLayoutBuilderTypeOption(layout,index)}function getLayoutBuilderTypeOption(layout,index){var output,optionClasses=["frm-layout-type-option","frm_grid_container","frm-layout-"+layout];if(index===NUMBER_OF_LAYOUT_OPTIONS-1)optionClasses.push("frm-last-layout-option");
output=div({class:optionClasses,children:map(layout.split("-"),div)});output.setAttribute("frm-layout",index+1);output.style.display="inline-grid";return output}function getLayoutBuilderModalWorkingSpace(){if(!layoutDataIsAlreadySet())return getLayoutBuilderPlaceholder();return getActiveLayoutBuilderModalWorkingSpace()}function layoutDataIsAlreadySet(){return!!state.layoutBuilderModalData}function getActiveLayoutData(){return dataProcessor.data[state.activeTab+"Layout"]}function setActiveLayoutData(data){dataProcessor.data[state.activeTab+
"Layout"]=data;refreshLayoutBuilderArea();boxProcessor.watch("addAddYourContentEducation",addAddYourContentEducation)}function getActiveLayoutBuilderModalWorkingSpace(){return div({id:"frm_layout_builder_modal_working_space",class:"frm_three_fourths",children:[getDroppableArea(),getLayoutFunction({isModalLayoutBuilder:true})({id:0,rows:state.layoutBuilderModalData}),getDroppableArea()]})}function getDroppableArea(){return div({class:"frm-views-droppable-placeholder",child:div({class:"frm-views-droppable-placeholder-highlight"})})}
function getLayoutFunction(args){var getLayoutBuilderRows,getLayoutBuilderRow,getLayoutBuilderBoxes,getLayoutBuilderBox,getBoxChild,idPrefix,has=makeHas(args),isModalLayoutBuilder=has("isModalLayoutBuilder")&&args.isModalLayoutBuilder,isModalLayoutBuilderSidebar=has("isModalLayoutBuilderSidebar")&&args.isModalLayoutBuilderSidebar,isEditBoxContentModal=has("isEditBoxContentModal")&&args.isEditBoxContentModal,isSimple=has("isSimple")&&args.isSimple,entryIndex=has("entryIndex")?args.entryIndex:0,useContent=
has("useContent")?args.useContent:false,isModal=isModalLayoutBuilder||isModalLayoutBuilderSidebar||isEditBoxContentModal,isMainContentArea=!isModal,layoutState={};if(isEditBoxContentModal){if(!has("selectedBoxId")){console.warn("formidable-views: in order to edit box content, a box must be selected!");return}layoutState.selectedBoxId=args.selectedBoxId}if(!isSimple){idPrefix="frm-";if(isModalLayoutBuilder)idPrefix+="lb";else if(isEditBoxContentModal)idPrefix+="bcm";else if(isMainContentArea)idPrefix+=
"mca-"+state.activeTab;idPrefix+="-box-"}getLayoutBuilderRows=function(data){var output;if(isModalLayoutBuilder){output=[];each(data,function(rowData,rowIndex){output.push(getLayoutBuilderRow(rowData));if(rowIndex!==data.length-1)output.push(getDroppableArea())});return output}return map(data,getLayoutBuilderRow)};getLayoutBuilderRow=function(rowData){var rowClass,row,outputArgs,output;if("undefined"===typeof rowData.boxes||!rowData.boxes.length)return emptyNode();if(useTableTags())return tag("tr",
{children:getLayoutBuilderBoxes(rowData.boxes)});rowClass=["frm-layout-builder-block","frm-layout-"+getLayoutClassName(rowData.layout),"frm_grid_container"];row=div({class:rowClass,children:getLayoutBuilderBoxes(rowData.boxes)});outputArgs={class:["frm-layout-builder-row","frm-layout-builder-row-with-"+rowData.boxes.length+"-boxes"],children:[row,div({text:"Row ID "+rowData.id,class:"frm-layout-builder-row-id"})]};output=div(outputArgs);output.setAttribute("frm-row-id",rowData.id);return output};
getLayoutBuilderBoxes=function(boxes){return map(boxes,getLayoutBuilderBox)};getLayoutBuilderBox=function(boxData){var boxArgs,boxChildArgs,output,isSelected=false,selectedClassName="frm-selected-layout-box",$document;if("undefined"!==typeof boxData.rows&&boxData.rows.length){if(useTableTags())boxArgs={class:["frm-layout-builder-box","frm-layout-builder-box-with-"+boxData.rows.length+"-rows"],children:getLayoutBuilderRows(boxData.rows)};else boxArgs={class:["frm-layout-builder-box","frm-layout-builder-box-with-"+
boxData.rows.length+"-rows"],children:[div({children:getLayoutBuilderRows(boxData.rows)})]};if(isMainContentArea&&0===boxData.id&&isGridType()){boxArgs.class.push("frm-view-editor-top-level-box");if(!isSimple){boxArgs.class.push("frm-top-level-box-with-mouse-events");$document=jQuery(document);$document.off("mouseover",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events");$document.off("mouseout",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events");$document.off("mouseover",
".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events .frm-layout-builder-box-with-0-rows");$document.off("mouseout",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events .frm-layout-builder-box-with-0-rows");$document.on("mouseover",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events",addActiveClassToTopLevelBox);$document.on("mouseout",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events",removeActiveClassFromTopLevelBox);$document.on("mouseover",
".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events",maybeAddPreviewAreaControls);$document.on("mouseover",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events .frm-layout-builder-box-with-0-rows",function(){this.classList.add("frm-lower-level-box-active");setTimeout(removeActiveClassFromTopLevelBox,0)});$document.on("mouseout",".frm-view-editor-top-level-box.frm-top-level-box-with-mouse-events .frm-layout-builder-box-with-0-rows",function(){this.classList.remove("frm-lower-level-box-active");
addActiveClassToTopLevelBox()})}maybeApplyStyle(boxData.id)}}else{boxChildArgs={};if(isMainContentArea&&!isSimple){boxChildArgs.id=idPrefix+boxData.id+"_child";boxChildArgs.onclick=function(){editBoxContentModal(boxData)}}boxArgs={class:["frm-layout-builder-box","frm-layout-builder-box-with-0-rows","with_frm_style"],child:getBoxChild(boxData,entryIndex,boxChildArgs)};if(isEditBoxContentModal){isSelected=layoutState.selectedBoxId===boxData.id;if(isSelected)boxArgs.class.push(selectedClassName);boxArgs.id=
idPrefix+boxData.id;boxArgs.onclick=function(){var selectedBox,box;selectedBox=document.getElementById(idPrefix+layoutState.selectedBoxId);box=document.getElementById(idPrefix+boxData.id);layoutState.selectedBoxId=boxData.id;selectedBox.classList.remove(selectedClassName);box.classList.add(selectedClassName);if(useContent)boxData.useContent=useContent;setBoxContentWysiwyg(boxData);setBoxDataListeners(boxData)}}if(isMainContentArea&&0===boxData.id)maybeApplyStyle(boxData.id)}if(useTableTags())output=
tag("td",boxArgs);else output=div(boxArgs);output.setAttribute("frm-box-id",boxData.id);return output};if(isMainContentArea)getBoxChild=function(boxData,index,boxChildArgs){return processBoxContent(boxData.id,index,isSimple,boxChildArgs)};else getBoxChild=emptyNode;return getLayoutBuilderBox}function maybeApplyStyle(boxId){var boxDataResult,style;boxDataResult=searchPageContentForBoxId(boxId);style="undefined"!==typeof boxDataResult.style?boxDataResult.style:{};setTimeout(function(){applyStyleToAllEntries(boxId,
style)},0)}function addActiveClassToTopLevelBox(){var box,boxes;box=document.querySelector(".frm-view-editor-top-level-box");boxes=box.querySelectorAll(".frm-layout-builder-box-with-0-rows");if(jQuery(boxes).filter(".frm-lower-level-box-active").length)return;box.classList.add("frm-top-level-box-active")}function removeActiveClassFromTopLevelBox(){document.querySelector(".frm-view-editor-top-level-box").classList.remove("frm-top-level-box-active")}function setBoxContentWysiwyg(boxData){var rawContent,
contentSetter;rawContent=getRawBoxContent(boxData,true);if(isTinyMceActive()){contentSetter=getActiveTinyMceContentSetter(rawContent);contentSetter();setTimeout(contentSetter,0)}else getBoxContentTextarea().value=rawContent}function getActiveTinyMceContentSetter(value){return function(){tinyMCE.activeEditor.setContent(value)}}function getBoxContentTextarea(){return document.getElementById("frm_box_content_wysiwyg_wrapper").querySelector("textarea")}function getBoxContentFromWysiwyg(){if(isTinyMceActive()&&
!tinyMCE.activeEditor.isHidden())return tinyMCE.activeEditor.getContent();return getBoxContentTextarea().value}function isTinyMceActive(){var wrapper=document.getElementById("wp-content-wrap");return null!==wrapper&&wrapper.classList.contains("tmce-active")}function editBoxContentModal(boxData){state.editBoxContentModalContent=getPageContent(boxData);if("object"===typeof state.editBoxContentModalContent)state.editBoxContentModalContent=deepClone(state.editBoxContentModalContent);state.hasResetTinyMceSinceModalLoad=
false;state.limitCustomizationSidebar="undefined"!==typeof boxData.useContent;maybeCreateModal({id:"frm_edit_box_content_modal",title:getEditBoxContentTitle(boxData),content:getBoxContentModalContent(boxData),footer:getBoxContentModalFooter(boxData)});setBoxContentWysiwyg(boxData);if(isTinyMceActive())resetTinyMce();else fixTextareaVisibility();addNavigateAcrossYourLayoutEducation()}function getEditBoxContentTitle(boxData){if("undefined"!==typeof boxData.useContent)return"before_content"===boxData.useContent?
__("Edit Before Content","formidable-views"):__("Edit After Content","formidable-views");return onListingTab()?__("Edit Listing Page Content","formidable-views"):__("Edit Detail Page Content","formidable-views")}function addNavigateAcrossYourLayoutEducation(){maybeAppendEducation(function(){return jQuery(document.getElementById("frm_modal_box_select_area").querySelector(".frm-selected-layout-box"))},function($target){appendEducationBelow($target,{title:__("Navigate across your layout","formidable-views"),
description:__("Start editing the content of multiple cells at once.","formidable-views"),key:"navigate-across-your-layout"})})}function resetTinyMce(){if(!state.hasResetTinyMceSinceModalLoad){removeTinyMce();initTinyMce();state.hasResetTinyMceSinceModalLoad=true}}function removeTinyMce(){var id="content";tinymce.EditorManager.execCommand("mceRemoveEditor",true,id)}function initTinyMce(){var id="content",key=Object.keys(tinyMCEPreInit.mceInit)[0],orgSettings=tinyMCEPreInit.mceInit[key],newValues=
{selector:"#"+id,body_class:orgSettings.body_class.replace(key,id),setup:setupTinyMceEventHandlers},newSettings=Object.assign({},orgSettings,newValues);if("undefined"!==typeof newSettings.toolbar1)newSettings.toolbar1=newSettings.toolbar1.replace(",link","");tinymce.init(newSettings);setTimeout(removeTinyMceMaxWidth,0)}function removeTinyMceMaxWidth(){jQuery("#content_ifr").contents().find("body").css({"max-width":"none"})}function setupTinyMceEventHandlers(editor){editor.on("Change",function(){handleTinyMceChange(editor)})}
function handleTinyMceChange(editor){jQuery(editor.targetElm).trigger("change")}function getUpdateBoxDataFunction(boxData){var boxId=boxData.id;return function(){var index,content,boxContentFromWysiwyg=getBoxContentFromWysiwyg(),updated=false;if("undefined"!==typeof boxData.useContent){if("before_content"===boxData.useContent)state.editBoxContentModalContent=boxContentFromWysiwyg;else if("after_content"===boxData.useContent)state.editBoxContentModalContent=boxContentFromWysiwyg;return}content=state.editBoxContentModalContent;
if(!Array.isArray(content))content=[];for(index=0;index<content.length;++index)if(boxId===content[index].box){content[index].content=boxContentFromWysiwyg;updated=true;break}if(!updated)content.push({box:boxId,content:boxContentFromWysiwyg});state.editBoxContentModalContent=content}}function getActivePageContent(){return dataProcessor.data[state.activeTab+"Content"]}function setupDataProcessor(){document.body.classList.add("frm-previewing-view");dataProcessor={hasData:false,data:false,poll:function(){dataProcessor.hasData=
false;getData(0,function(data){dataProcessor.hasData=true;dataProcessor.data=data;each(dataProcessor.listeners,function(listener){listener()})})},placeholder:function(key,dataHandler,tagType){var placeholder="undefined"!==typeof tagType?tag(tagType):div();dataProcessor.get(key,function(data){placeholder.appendChild(dataHandler(data))});return placeholder},get:function(key,getSuccessCallback){if(dataProcessor.hasData)getSuccessCallback(dataProcessor.data[key]);else dataProcessor.waitForData(function(){getSuccessCallback(dataProcessor.data[key])})},
listeners:[],waitForData:function(callback){dataProcessor.listeners.push(callback)}};dataProcessor.poll()}function getData(partial,success){var data={action:"frm_views_editor_get_data",view:frmViewsEditorViewData.id,partial:partial,nonce:frmGlobal.nonce};post(data,success)}function setupBoxProcessor(){boxProcessor={state:{hasData:false,data:false,polling:false,successListeners:[],persistentSuccessListeners:{beforeContent:function(){},afterContent:function(){},addAddYourContentEducation:function(){}},
activePollId:false,details:{entryCount:0,beforeContent:"",afterContent:""}},pollServer:function(){var pollId,limit,payload;boxProcessor.state.successListeners=[];boxProcessor.state.polling=true;boxProcessor.state.hasData=false;pollId=autoId();boxProcessor.state.activePollId=pollId;if("detail"===state.activeTab||isSingleEntryType())limit=1;else limit=dataProcessor.data.limit;payload={action:"frm_views_process_box_preview",tab:state.activeTab,data:getActivePageContent(),view:frmViewsEditorViewData.id,
form:frmViewsEditorViewData.formId,limit:limit,pageSize:dataProcessor.data.pageSize,filter:filterForValidFilterRules(dataProcessor.data.filterEntries),sort:filterForValidSortRules(dataProcessor.data.sortEntries),detailSlug:dataProcessor.data.detailSlug,parameterValue:dataProcessor.data.parameterValue,activePreviewFilter:frmViewsEditorViewData.activePreviewFilter,nonce:frmGlobal.nonce};if(onListingTab()){payload.beforeContent=dataProcessor.data.listingBeforeContent;payload.afterContent=dataProcessor.data.listingAfterContent}document.body.classList.add("frm-previewing-view");
post(payload,function(data){if(pollId!==boxProcessor.state.activePollId)return;if(data.length&&"undefined"!==typeof data[data.length-1].entryCount)boxProcessor.applyAdditionalDetails(data.pop());boxProcessor.state.hasData=true;boxProcessor.state.data=data;boxProcessor.state.hasData.polling=false;if(data.length)each(boxProcessor.state.successListeners,function(listener){listener()});else if(!shouldActivePageUsePlaceholder())redrawLayoutBuilderArea();boxProcessor.state.persistentSuccessListeners.beforeContent();
boxProcessor.state.persistentSuccessListeners.afterContent();boxProcessor.state.persistentSuccessListeners.addAddYourContentEducation();jQuery(document.getElementById("view-editor")).trigger("frm-box-processor-success");document.body.classList.remove("frm-previewing-view")})},pullContent:function(boxId,entryIndex){var entry;if(!boxProcessor.state.hasData)return"";if(entryIndex>=boxProcessor.state.data.length){trimListingPageLength(entryIndex);return""}if("undefined"===typeof boxProcessor.state.data[entryIndex])return"";
entry=boxProcessor.state.data[entryIndex];if("undefined"!==typeof entry[boxId])return entry[boxId];return""},process:function(boxId,entryIndex,callback){var handleSuccess=function(){callback(boxProcessor.pullContent(boxId,entryIndex))};if(boxProcessor.state.hasData)return handleSuccess();if(!boxProcessor.state.polling)boxProcessor.pollServer();boxProcessor.waitForPollSuccess(handleSuccess)},waitForPollSuccess:function(callback){boxProcessor.state.successListeners.push(callback)},applyAdditionalDetails:function(details){boxProcessor.state.details.entryCount=
details.entryCount;if("undefined"!==typeof details.beforeContent)boxProcessor.state.details.beforeContent=details.beforeContent;if("undefined"!==typeof details.afterContent)boxProcessor.state.details.afterContent=details.afterContent;if("undefined"!==typeof details.names)boxProcessor.state.details.names=details.names;if("undefined"!==typeof details.googleGraphs){__FRMTABLES=details.googleGraphs;frmProFormJS().loadGoogle()}},watch:function(key,callback){if(boxProcessor.state.hasData)callback();boxProcessor.state.persistentSuccessListeners[key]=
callback}}}function trimListingPageLength(length){var offset,index,$fadedLayouts,$lastAvailableEntry;offset=2;index=length-offset;if(isTableType())$fadedLayouts=jQuery(document.getElementById("frm_table_editor_table")).find("tbody tr:not(:first-of-type)");else $fadedLayouts=jQuery(".frm-fade-layout");if(index<0){$fadedLayouts.remove();return}if($fadedLayouts.length<=index)return;$lastAvailableEntry=jQuery($fadedLayouts.get(index));if(isTableType())$lastAvailableEntry.nextAll("tr").remove();else $lastAvailableEntry.nextAll(".frm-fade-layout").remove()}
function processBoxContent(boxId,entryIndex,isSimple,placeholderArgs){var placeholder,onProcessorSuccess;if("undefined"===typeof placeholderArgs)placeholderArgs={};if("undefined"===typeof placeholderArgs.class)placeholderArgs.class=[];else if("string"===typeof placeholderArgs.class)placeholderArgs.class=[placeholderArgs.class];placeholderArgs.class.push("frm-views-box-placeholder","frm-disable-clicking-in-content");placeholder=div(placeholderArgs);onProcessorSuccess=function(html){var hasRawBoxContent,
isEmpty,boxData;hasRawBoxContent=getRawBoxContent({id:boxId}).length>0;isEmpty=hasRawBoxContent?!html.length:isSimple;placeholder.classList.remove("frm-views-box-placeholder");if(isEmpty)markPlaceholderEmpty(placeholder);else if(hasRawBoxContent){html=html.replace(/&lt;/g,"<").replace(/&gt;/g,">");if(useHtmlInsteadOfPreview())placeholder.appendChild(div({text:html}));else placeholder.appendChild(div({html:html}));if(isSimple&&!useTableTags())placeholder.classList.add("frm-unfade")}else placeholder.appendChild(getPlusIcon());
boxData=searchPageContentForBoxId(boxId);if("undefined"!==typeof boxData.style)applyStyles(placeholder,boxData.style,false)};boxProcessor.process(boxId,entryIndex,onProcessorSuccess);return placeholder}function useHtmlInsteadOfPreview(){var disablePreviewCheckbox;if(!dataProcessor.data.disablePreview&&isLegacyTableType()){dataProcessor.data.disablePreview=1;disablePreviewCheckbox=document.getElementById("frm_views_disable_preview");disablePreviewCheckbox.checked=true;toggleCodeViewActiveClass(true);
refreshActivePreviews();return 1}return dataProcessor.data.disablePreview}function applyStyles(element,styles,enforceMinimumPadding,updatingStyles){var applyStyle=function(key){if("fontSize"===key||"lineHeight"===key){setTimeout(function(){var style,targetBoxes;style=styles[key];targetBoxes=element.querySelectorAll(".frm-layout-builder-box-with-0-rows");if(targetBoxes.length)each(targetBoxes,function(targetBox){applyFontSizeStyleToEmptyBoxesWithoutStyles(targetBox,styles,key)});else if(""!==style)element.style[key]=
style;else setElementFontSizeToDefault(element,key)},0);return}if("padding"===key&&enforceMinimumPadding&&paddingValueIsTooLowToDisplayInEditor(styles[key]))element.style[key]="10px";else element.style[key]=styles[key]};each(Object.keys(styles),applyStyle);if(0===state.styleEditorIsActive&&isGridType()&&("undefined"===typeof updatingStyles||!updatingStyles)){if("undefined"===typeof styles.borderColor)element.style.borderColor=frmViewsEditorInfo.defaultGridStyles.borderColor;if("undefined"===typeof styles.borderStyle)element.style.borderStyle=
frmViewsEditorInfo.defaultGridStyles.borderStyle;if("undefined"===typeof styles.borderWidth)element.style.borderWidth=frmViewsEditorInfo.defaultGridStyles.borderWidth}}function applyFontSizeStyleToEmptyBoxesWithoutStyles(targetBox,styles,key){var targetBoxId,boxData,targetBoxStyle,targetBoxHasNoStylesSet,targetBoxHasContent;targetBoxId=targetBox.getAttribute("frm-box-id");boxData=searchPageContentForBoxId(parseInt(targetBoxId));targetBoxStyle="undefined"!==typeof boxData.style?boxData.style:{};targetBoxHasNoStylesSet=
"undefined"===typeof targetBoxStyle[key]||""===targetBoxStyle[key];targetBoxHasContent="undefined"!==typeof boxData.content&&boxData.content.length>0;if(targetBoxHasNoStylesSet&&targetBoxHasContent)targetBox.firstChild.style[key]=styles[key]}function setElementFontSizeToDefault(element,key){var boxData,targetBoxStyle;boxData=searchPageContentForBoxId(0);targetBoxStyle="undefined"!==typeof boxData.style?boxData.style:{};element.style[key]="undefined"!==typeof targetBoxStyle[key]?targetBoxStyle[key]:
""}function paddingValueIsTooLowToDisplayInEditor(padding){var split,index,length,currentPadding;if("0"===padding)return true;split=padding.split(" ");length=split.length;for(index=0;index<length;++index){currentPadding=split[index];if("0"===currentPadding)return true;if(2>currentPadding.length||"px"!==currentPadding.substr(-2))return true;if("px"===currentPadding.substr(-2)&&10>parseInt(currentPadding.replace("px","")))return true}return false}function markPlaceholderEmpty(placeholder){placeholder.classList.add("frm-empty-preview-cell")}
function getPlusIcon(){var plusIcon=div({icon:"frm_views_editor_plus_circle"});plusIcon.classList.add("frm-add-content-to-layout-block");return plusIcon}function getLayoutClassName(layout){switch(layout){case LAYOUTS.ONE_COLUMN:return"1";case LAYOUTS.TWO_COLUMN:return"1-1";case LAYOUTS.THREE_COLUMN:return"1-1-1";case LAYOUTS.FOUR_COLUMN:return"1-1-1-1";case LAYOUTS.ONE_THREE:return"1-3";case LAYOUTS.THREE_ONE:return"3-1";case LAYOUTS.ONE_TWO_ONE:return"1-2-1";case LAYOUTS.ONE_TWO:return"1-2";case LAYOUTS.TWO_ONE:return"2-1"}return layout}
function getBoxContentModalContent(boxData){var getWysiwygArea,getModalBoxSelectArea,getWysiwygSidebar;getWysiwygArea=function(){setBoxDataListeners(boxData);return div({id:"frm_box_content_wysiwyg_wrapper",class:"frm_three_fourths",child:getWysiwyg()})};getModalBoxSelectArea=function(){var layoutFunction;if(!isGridType())return emptyNode();if("undefined"!==typeof boxData.useContent)return emptyNode();if(thereIsOnlyOneBoxOptionToSelect())return emptyNode();layoutFunction=getLayoutFunction({isEditBoxContentModal:true,
selectedBoxId:boxData.id,useContent:boxData.useContent});return layoutFunction({id:0,rows:getActiveLayoutData()})};getWysiwygSidebar=function(){var customizationSidebar=document.getElementById("frm_adv_info");if(state.limitCustomizationSidebar)customizationSidebar.classList.add("frm-limited-customization-sidebar");else customizationSidebar.classList.remove("frm-limited-customization-sidebar");return div({id:"frm_modal_box_select_area",class:"frm_fourth",children:[getModalBoxSelectArea(),customizationSidebar]})};
return div({class:["frm_grid_container","frm-education-wrapper"],children:[getWysiwygArea(),getWysiwygSidebar()]})}function setBoxDataListeners(boxData){jQuery(document).off("change focus","#frm_box_content_wysiwyg_wrapper textarea");jQuery(document).on("change focus","#frm_box_content_wysiwyg_wrapper textarea",getUpdateBoxDataFunction(boxData))}function getWysiwyg(){if(dataProcessor.data.disablePreview)return document.getElementById("postdiv")||document.getElementById("postdivrich");return document.getElementById("postdivrich")||
document.getElementById("postdiv")}function thereIsOnlyOneBoxOptionToSelect(){var rows=getActiveLayoutData();if(rows.length<1)return true;if(rows.length>1)return false;return!rowContainsMoreThanOneBox(rows[0])}function rowContainsMoreThanOneBox(row){var box;if(row.boxes.length>1)return true;if(row.boxes.length<1)return false;box=row.boxes[0];return boxContainsMoreThanOneBox(box)}function boxContainsMoreThanOneBox(box){var length,index,row;if("undefined"===typeof box.rows)return false;length=box.rows.length;
for(index=0;index<length;++index){row=box.rows[index];if(rowContainsMoreThanOneBox(row))return true}return false}function getRawBoxContent(boxData,useBoxContent){var content,boxId,index;content=useBoxContent?state.editBoxContentModalContent:getPageContent(boxData);if("undefined"!==typeof boxData.useContent)return content;boxId=boxData.id;if(0===boxId&&"string"===typeof content)return content;for(index=0;index<content.length;++index)if(boxId===content[index].box)return content[index].content;return""}
function getPageContent(boxData){if("undefined"!==typeof boxData.useContent){if("before_content"===boxData.useContent)return dataProcessor.data.listingBeforeContent;if("after_content"===boxData.useContent)return dataProcessor.data.listingAfterContent}return getActivePageContent()}function getBoxContentModalFooter(boxData){var modalId="frm_edit_box_content_modal";return div({children:[getCancelButton(modalId,true),getUpdateViewButton(boxData,modalId)]})}function getCancelButton(modalId,addRightMargin){var output=
button({text:__("Cancel","formidable-views"),class:"frm-views-modal-cancel-button",id:"frm_cancel_"+modalId,onclickPreventDefault:function(){closeModal(modalId)}});if(addRightMargin)output.style.marginRight="10px";return output}function closeModal(modalId){jQuery("#"+modalId).dialog("close")}function getUpdateViewButton(boxData,modalId){return button({id:"frm_update_box_content_button",onclickPreventDefault:function(){updateBoxContent(boxData);closeModal(modalId)},text:__("Update view","formidable-views")})}
function updateBoxContent(boxData){var content=state.editBoxContentModalContent;if("undefined"!==typeof boxData.useContent){if("before_content"===boxData.useContent)updateBeforeContent(content);else if("after_content"===boxData.useContent)updateAfterContent(content);refreshLayoutBuilderArea()}else updateActivePageContent(content,true);saveViewEditor();refreshActiveViewTypeDescription();addSomeAdditionalViewSettingsEducation()}function updateBeforeContent(content){var disablePreview;dataProcessor.data.listingBeforeContent=
content;redrawBeforeAfterContent("before");disablePreview=document.getElementById("frm_views_disable_preview");if(null!==disablePreview)disablePreview.disabled=isLegacyTableType();updateBeforeContentInput(content)}function updateBeforeContentInput(content){var input;if(isTableType())return;input=document.getElementById("before_content");input.value=content;jQuery(input).trigger("change")}function updateAfterContent(content){dataProcessor.data.listingAfterContent=content;redrawBeforeAfterContent("after")}
function redrawBeforeAfterContent(type){var wrapperId,wrapper;wrapperId="frm_"+type+"_view_content_wrapper";wrapper=document.getElementById(wrapperId);if(null===wrapper)return;redraw(wrapper.parentNode,getBeforeOrAfterContentWrapper(type))}function updateActivePageContent(content,refresh){dataProcessor.data[state.activeTab+"Content"]=content;if(refresh)refreshLayoutBuilderArea()}function refreshLayoutBuilderArea(){boxProcessor.pollServer();redrawLayoutBuilderArea()}function redrawLayoutBuilderArea(){var layoutBuilderArea=
document.getElementById("frm_layout_builder_area");if(null===layoutBuilderArea)return;layoutBuilderArea.innerHTML="";layoutBuilderArea.appendChild(processActivePageContent().firstChild)}function addSomeAdditionalViewSettingsEducation(){maybeAppendEducation(function(){return jQuery(document.getElementById("frm_view_editor_filter_sort_wrapper"))},function($target){appendEducationBelow($target,{title:__("Additional view settings","formidable-views"),description:getAdditionalViewSettingsEducationDescription(),
key:"additional-view-settings"})})}function getAdditionalViewSettingsEducationDescription(){if(isGridType())return __("Filter form entries, sort data, and toggle the layout builder at any time.","formidable-views");return __("Filter and sort form entries at any time.","formidable-views")}function getLayoutBuilderPlaceholder(){return div({class:["frm-working-space-border","frmcenter"],padding:"30px",child:getLayoutBuilderPlaceholderWrapper()})}function getLayoutBuilderPlaceholderWrapper(){if(onListingTab())return getRepeatableLayoutDescription();
return getCustomLayoutDescription(true)}function getCustomLayoutSVG(){var svg=getSVG("custom-layout");svg.style.transform="translateX( -20px )";return svg}function getCheckmarkListItems(items){return div({children:map(items,getCheckmarkListItem)})}function getCheckmarkListItem(text){return div({class:"frm-checkbox-list-item",children:[getCheckmark(),span({text:text,margin:"0 0 0 7px"})]})}function getCheckmark(){return div({icon:"frm_views_editor_checkmark"})}function deepClone(object){return JSON.parse(JSON.stringify(object))}
function redrawLayoutBuilderModalWorkingSpace(){var workingSpace=document.getElementById("frm_layout_builder_modal_working_space");if(null===workingSpace)workingSpace=document.getElementById("frm_layout_builder_modal_main_area").querySelector(".frm-working-space-border");workingSpace.parentNode.replaceChild(getLayoutBuilderModalWorkingSpace(),workingSpace);makeWorkingAreaDroppable()}function redrawLayoutBuilderFooter(){var modalId,footer;modalId="frm_layout_builder_modal";footer=document.getElementById("frm_layout_builder_modal_footer");
jQuery(footer).after(getLayoutBuilderModalFooter(modalId));footer.remove();if(layoutDataIsAlreadySet()&&""===getActiveLayoutData())jQuery(document).one("mouseover","#frm_layout_builder_modal .frm_modal_footer",function(){addAreYouReadyToAddDataEducation()})}function getLayoutBuilderModalFooter(modalId){var children=[];if(layoutDataIsAlreadySet())children.push(getCancelButton(modalId,true),getSaveLayoutButton(modalId));return div({id:"frm_layout_builder_modal_footer",children:children})}function getSaveLayoutButton(modalId){return button({id:"frm_save_layout",
onclickPreventDefault:function(){saveLayout();closeModal(modalId)},text:__("Save layout","formidable-views")})}function appendToLayoutBuilderModalWorkingSpace(element){document.getElementById("frm_layout_builder_modal_working_space").firstChild.appendChild(element)}function saveLayout(){setActiveLayoutData(state.layoutBuilderModalData);saveViewEditor()}function autoId(){return++currentAutoId}function getBoxAutoId(){if(-1===boxAutoId)if(layoutBuilderModalIsActive())boxAutoId=searchRowsForHighestBoxId(state.layoutBuilderModalData);
else boxAutoId=searchRowsForHighestBoxId(getActiveLayoutData());boxAutoId++;return boxAutoId}function layoutBuilderModalIsActive(){var modal=document.getElementById("frm_layout_builder_modal");return null!==modal&&"none"!==modal.style.display}function searchRowsForHighestBoxId(rows){var index,row,highestBoxIdFromBoxData,length=rows.length,highestBoxId=-1;for(index=0;index<length;++index){row=rows[index];if(row.id>highestBoxId)highestBoxId=row.id;if("undefined"===typeof row.boxes)continue;highestBoxIdFromBoxData=
searchBoxesForHighestId(row.boxes);if(highestBoxIdFromBoxData>highestBoxId)highestBoxId=highestBoxIdFromBoxData}return highestBoxId}function searchBoxesForHighestId(boxes){var index,box,highestBoxIdFromRowData,length=boxes.length,highestBoxId=-1;for(index=0;index<length;++index){box=boxes[index];if(box.id>highestBoxId)highestBoxId=box.id;if("undefined"!==typeof box.rows){highestBoxIdFromRowData=searchRowsForHighestBoxId(box.rows);if(highestBoxIdFromRowData>highestBoxId)highestBoxId=highestBoxIdFromRowData}}return highestBoxId}
function separator(){return tag("hr")}function saveViewEditor(){var data={};data=Object.assign(data,frmViewsEditorViewData,dataProcessor.data);delete data.fieldOptions;data.action="frm_views_editor_update";data.nonce=frmGlobal.nonce;data.showCount=getActiveShowCount();data.viewKey=state.viewKey;data.metaboxData=getSerializedMetaboxData();data.isGridType=frmViewsEditorInfo.isGridType;data.isTableType=frmViewsEditorInfo.isTableType;data.filterEntries=filterForValidFilterRules(data.filterEntries);data.sortEntries=
filterForValidSortRules(data.sortEntries);data.filterEntries=filterForValidFilterRules(data.filterEntries);data.sortEntries=filterForValidSortRules(data.sortEntries);if("undefined"!==typeof this.classList)this.classList.add("frm_loading_button");toggleOffCellStyleSettings();post(data,handleViewEditorUpdateSuccess,handleViewEditorUpdateError)}function getActiveShowCount(){if(isSingleEntryType())return"one";if(isCalendarType())return"calendar";return viewIsDynamic()?"dynamic":"all"}function getSerializedMetaboxData(){var form=
document.getElementById("frm_view_editor_metabox_form");if(null===form)return"";return jQuery(form).serialize()}function handleViewEditorUpdateSuccess(data){var aNewViewKeyWasCreated="undefined"!==typeof data.viewKey;document.getElementById("publish").classList.remove("frm_loading_button");if(aNewViewKeyWasCreated)state.viewKey=data.viewKey;if(""!==frmViewsEditorViewData.viewKey)frmViewsEditorInfo.viewUrl=frmViewsEditorInfo.viewUrl.replace(frmViewsEditorViewData.viewKey,state.viewKey);frmViewsEditorViewData.viewKey=
state.viewKey;if(aNewViewKeyWasCreated){frmViewsEditorViewData.viewKey=data.viewKey;maybeUpdateViewKeyInput(data.viewKey)}state.preventUnsavedChanges=false;success(div({margin:"10px 0",text:__("View successfully saved!","formidable-views")}))}function maybeUpdateViewKeyInput(viewKey){var viewKeyInput=document.getElementById("frm_views_view_key");if(null!==viewKeyInput)viewKeyInput.value=viewKey}function handleViewEditorUpdateError(){document.getElementById("publish").classList.remove("frm_loading_button")}
function preventUnsavedChanges(){if(!state.preventUnsavedChanges){state.preventUnsavedChanges=true;window.addEventListener("beforeunload",confirmExit)}}function confirmExit(event){if(state.preventUnsavedChanges){event.preventDefault();event.returnValue=""}}function setupExternalFunctionReferences(){if("undefined"!==typeof frmViewsDom){tag=frmViewsDom.tag;div=frmViewsDom.div;span=frmViewsDom.span;emptyNode=frmViewsDom.emptyNode;a=frmViewsDom.a;button=frmViewsDom.button;select=frmViewsDom.select;option=
frmViewsDom.option;pullOptionsFrom=frmViewsDom.pullOptionsFrom;radios=frmViewsDom.radios;input=frmViewsDom.input;tabs=frmViewsDom.tabs;collapsible=frmViewsDom.collapsible;redraw=frmViewsDom.redraw;success=frmViewsDom.success}if("undefined"!==typeof frmViewsModal){maybeCreateModal=frmViewsModal.maybeCreateModal;recenterModal=frmViewsModal.recenterModal}if("undefined"!==typeof frmViewsUtil){each=frmViewsUtil.each;map=frmViewsUtil.map;makeHas=frmViewsUtil.makeHas;post=frmViewsUtil.post}if("undefined"!==
typeof frmViewsTable)getTableSelectAllAndSearchOptions=frmViewsTable.getTableSelectAllAndSearchOptions}setupExternalFunctionReferences();setupDataProcessor();setupBoxProcessor();jQuery(document).ready(initialize)})();
